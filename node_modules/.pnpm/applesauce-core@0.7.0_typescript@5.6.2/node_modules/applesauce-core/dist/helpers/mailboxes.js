import { safeRelayUrl } from "./relays.js";
export const MailboxesInboxesSymbol = Symbol.for("mailboxes-inboxes");
export const MailboxesOutboxesSymbol = Symbol.for("mailboxes-outboxes");
/**
 * Parses a 10002 event and stores the inboxes in the event using the {@link MailboxesInboxesSymbol} symbol
 */
export function getInboxes(event) {
    if (!event[MailboxesInboxesSymbol]) {
        const inboxes = new Set();
        for (const tag of event.tags) {
            if (tag[0] === "r" && tag[1] && (tag[2] === "read" || tag[2] === undefined)) {
                const url = safeRelayUrl(tag[1]);
                if (url)
                    inboxes.add(url);
            }
        }
        event[MailboxesInboxesSymbol] = inboxes;
    }
    return event[MailboxesInboxesSymbol];
}
/**
 * Parses a 10002 event and stores the outboxes in the event using the {@link MailboxesOutboxesSymbol} symbol
 */
export function getOutboxes(event) {
    if (!event[MailboxesOutboxesSymbol]) {
        const outboxes = new Set();
        for (const tag of event.tags) {
            if (tag[0] === "r" && tag[1] && (tag[2] === "write" || tag[2] === undefined)) {
                const url = safeRelayUrl(tag[1]);
                if (url)
                    outboxes.add(url);
            }
        }
        event[MailboxesOutboxesSymbol] = outboxes;
    }
    return event[MailboxesOutboxesSymbol];
}
