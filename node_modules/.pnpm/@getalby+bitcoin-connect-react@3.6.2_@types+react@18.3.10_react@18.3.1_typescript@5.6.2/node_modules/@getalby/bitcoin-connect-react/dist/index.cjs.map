{"version":3,"file":"index.cjs","sources":["../src/hooks/useCoreEvents.ts","../src/hooks/useOnPaid.ts","../src/components/Button.tsx","../src/components/Connect.tsx","../src/components/PayButton.tsx","../src/components/Payment.tsx"],"sourcesContent":["import React from 'react';\nimport {ComponentProps} from '../types/ComponentProps';\nimport {\n  onConnected,\n  onConnecting,\n  onDisconnected,\n  onModalClosed,\n  onModalOpened,\n} from '@getalby/bitcoin-connect';\n\nexport function useCoreEvents(props: ComponentProps) {\n  React.useEffect(() => {\n    if (props.onConnected) {\n      const unsub = onConnected(props.onConnected);\n\n      return () => {\n        unsub();\n      };\n    }\n    return () => {};\n  }, []);\n  React.useEffect(() => {\n    if (props.onConnecting) {\n      const unsub = onConnecting(props.onConnecting);\n\n      return () => {\n        unsub();\n      };\n    }\n    return () => {};\n  }, []);\n  React.useEffect(() => {\n    if (props.onDisconnected) {\n      const unsub = onDisconnected(props.onDisconnected);\n\n      return () => {\n        unsub();\n      };\n    }\n    return () => {};\n  }, []);\n  React.useEffect(() => {\n    if (props.onModalOpened) {\n      const unsub = onModalOpened(props.onModalOpened);\n\n      return () => {\n        unsub();\n      };\n    }\n    return () => {};\n  }, []);\n  React.useEffect(() => {\n    if (props.onModalClosed) {\n      const unsub = onModalClosed(props.onModalClosed);\n\n      return () => {\n        unsub();\n      };\n    }\n    return () => {};\n  }, []);\n}\n","import {SendPaymentResponse} from '@webbtc/webln-types';\nimport React from 'react';\n\nexport function useOnPaid(\n  onPaid?: (response: SendPaymentResponse) => void,\n  payment?: SendPaymentResponse\n) {\n  React.useEffect(() => {\n    const onPaidEventHandler = (event: Event) => {\n      onPaid?.((event as CustomEvent).detail);\n    };\n    window.addEventListener('bc:onpaid', onPaidEventHandler);\n\n    if (payment) {\n      // TODO: remove once bc-send-payment accepts preimage\n      window.dispatchEvent(\n        new CustomEvent('bc:onpaid', {\n          detail: payment,\n        })\n      );\n    }\n\n    return () => {\n      window.removeEventListener('bc:onpaid', onPaidEventHandler);\n    };\n  }, [onPaid, payment]);\n}\n","import React from 'react';\nimport '@getalby/bitcoin-connect';\nimport {ComponentProps} from '../types/ComponentProps';\nimport {useCoreEvents} from '../hooks/useCoreEvents';\n\ntype ButtonProps = ComponentProps & {};\n\nexport const Button: React.FC<ButtonProps> = (props) => {\n  useCoreEvents(props);\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return <bc-button />;\n};\n","import React from 'react';\nimport '@getalby/bitcoin-connect';\nimport {ComponentProps} from '../types/ComponentProps';\nimport {useCoreEvents} from '../hooks/useCoreEvents';\n\ntype ConnectProps = ComponentProps & {};\n\nexport const Connect: React.FC<ConnectProps> = (props) => {\n  useCoreEvents(props);\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return <bc-connect />;\n};\n","import React from 'react';\nimport '@getalby/bitcoin-connect';\nimport {PaymentMethods} from '@getalby/bitcoin-connect';\nimport {ComponentProps} from '../types/ComponentProps';\nimport {useCoreEvents} from '../hooks/useCoreEvents';\nimport {SendPaymentResponse} from '@webbtc/webln-types';\nimport {useOnPaid} from '../hooks/useOnPaid';\n\ntype PayButtonProps = ComponentProps & {\n  /**\n   * Bolt 11 invoice to pay\n   */\n  invoice?: string;\n  /**\n   * Supported payment methods in payment flow\n   */\n  paymentMethods?: PaymentMethods;\n  /**\n   * @param response response of the WebLN send payment call\n   */\n  onPaid?: (response: SendPaymentResponse) => void;\n  /**\n   * Mark that an external payment was made\n   */\n  payment?: SendPaymentResponse;\n\n  /**\n   * Listen to when the pay button is clicked.\n   * This is a good time to fetch an invoice to pay.\n   */\n  onClick?: () => void;\n};\n\nexport const PayButton: React.FC<PayButtonProps> = (props) => {\n  useCoreEvents(props);\n\n  const {onPaid, payment} = props;\n  useOnPaid(onPaid, payment);\n\n  return (\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    <bc-pay-button\n      invoice={props.invoice}\n      {...(props.paymentMethods\n        ? {'payment-methods': props.paymentMethods}\n        : {})}\n      preimage={payment?.preimage}\n      onClick={props.onClick}\n    />\n  );\n};\n","import React from 'react';\nimport '@getalby/bitcoin-connect';\nimport {ComponentProps} from '../types/ComponentProps';\nimport {useCoreEvents} from '../hooks/useCoreEvents';\nimport {SendPaymentResponse} from '@webbtc/webln-types';\nimport {useOnPaid} from '../hooks/useOnPaid';\nimport {PaymentMethods} from '@getalby/bitcoin-connect';\n\ntype PaymentProps = ComponentProps & {\n  /**\n   * Bolt 11 invoice to pay\n   */\n  invoice: string;\n  /**\n   * Supported payment methods in payment flow\n   */\n  paymentMethods?: PaymentMethods;\n  /**\n   * @param response response of the WebLN send payment call\n   */\n  onPaid?: (response: SendPaymentResponse) => void;\n  /**\n   * Mark that an external payment was made\n   */\n  payment?: SendPaymentResponse;\n};\n\nexport const Payment: React.FC<PaymentProps> = (props) => {\n  useCoreEvents(props);\n\n  const {onPaid, payment} = props;\n  useOnPaid(onPaid, payment);\n\n  return (\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    <bc-payment\n      invoice={props.invoice}\n      {...(props.paymentMethods\n        ? {'payment-methods': props.paymentMethods}\n        : {})}\n      {...(payment ? {paid: true} : {})}\n    />\n  );\n};\n"],"names":["useCoreEvents","props","React","useEffect","onConnected","unsub","onConnecting","onDisconnected","onModalOpened","onModalClosed","useOnPaid","onPaid","payment","onPaidEventHandler","event","detail","window","addEventListener","dispatchEvent","CustomEvent","removeEventListener","createElement","_extends","invoice","paymentMethods","preimage","onClick","paid"],"mappings":"sKAUgBA,EAAcC,GAC5BC,EAAK,QAACC,UAAU,WACd,GAAIF,EAAMG,YAAa,CACrB,IAAMC,EAAQD,EAAWA,YAACH,EAAMG,aAEhC,OAAO,WACLC,GACF,CACD,CACD,OAAc,WAAA,CAChB,EAAG,IACHH,EAAAA,QAAMC,UAAU,WACd,GAAIF,EAAMK,aAAc,CACtB,IAAMD,EAAQC,EAAAA,aAAaL,EAAMK,cAEjC,kBACED,GACF,CACD,CACD,OAAc,YAChB,EAAG,IACHH,UAAMC,UAAU,WACd,GAAIF,EAAMM,eAAgB,CACxB,IAAMF,EAAQE,iBAAeN,EAAMM,gBAEnC,OAAO,WACLF,GACF,CACD,CACD,OAAc,WAChB,CAAA,EAAG,IACHH,EAAK,QAACC,UAAU,WACd,GAAIF,EAAMO,cAAe,CACvB,IAAMH,EAAQG,EAAaA,cAACP,EAAMO,eAElC,OAAY,WACVH,GACF,CACD,CACD,OAAO,WAAO,CAChB,EAAG,IACHH,EAAAA,QAAMC,UAAU,WACd,GAAIF,EAAMQ,cAAe,CACvB,IAAMJ,EAAQI,EAAAA,cAAcR,EAAMQ,eAElC,OAAO,WACLJ,GACF,CACD,CACD,OAAc,YAChB,EAAG,GACL,qOC1DgB,SAAAK,EACdC,EACAC,GAEAV,EAAAA,QAAMC,UAAU,WACd,IAAMU,EAAqB,SAACC,GACpB,MAANH,GAAAA,EAAUG,EAAsBC,OAClC,EAYA,OAXAC,OAAOC,iBAAiB,YAAaJ,GAEjCD,GAEFI,OAAOE,cACL,IAAIC,YAAY,YAAa,CAC3BJ,OAAQH,KAKF,WACVI,OAAOI,oBAAoB,YAAaP,EAC1C,CACF,EAAG,CAACF,EAAQC,GACd,o5CCnB6C,SAACX,GAK5C,OAJAD,EAAcC,gBAIPC,yCACT,kBCN+C,SAACD,GAK9C,OAJAD,EAAcC,gBAIPC,0CACT,oBCoBmD,SAACD,GAClDD,EAAcC,GAEd,IAAeW,EAAWX,EAAXW,QAGf,OAFAF,EAD0BT,EAAnBU,OACWC,gBAKhBV,EACE,QAAAmB,cAAA,gBAAAC,EAAAC,CAAAA,QAAStB,EAAMsB,SACVtB,EAAMuB,eACP,CAAC,kBAAmBvB,EAAMuB,gBAC1B,CAAE,EACNC,CAAAA,eAAUb,SAAAA,EAASa,SACnBC,QAASzB,EAAMyB,UAGrB,kBCxB+C,SAACzB,GAC9CD,EAAcC,GAEd,IAAeW,EAAWX,EAAXW,QAGf,OAFAF,EAD0BT,EAAnBU,OACWC,gBAKhBV,UACEmB,cAAA,aAAAC,GAAAC,QAAStB,EAAMsB,SACVtB,EAAMuB,eACP,CAAC,kBAAmBvB,EAAMuB,gBAC1B,CAAA,EACCZ,EAAU,CAACe,MAAM,GAAQ,CAAA,GAGpC"}