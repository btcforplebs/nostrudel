import sqlite3InitModule from "@sqlite.org/sqlite-wasm";
import { EventEmitter } from "eventemitter3";
import { unixNowMs } from "../types";
import migrate from "./migrations";
import { debugLog } from "../debug";
// import wasm file directly, this needs to be copied from https://sqlite.org/download.html
import SqlitePath from "./sqlite3.wasm?url";
import { runFixers } from "./fixers";
export class SqliteRelay extends EventEmitter {
    #sqlite;
    #log = (msg, ...args) => debugLog("SqliteRelay", msg, ...args);
    db;
    #pool;
    #seenInserts = new Set();
    /**
     * Initialize the SQLite driver
     */
    async init(path) {
        if (this.#sqlite)
            return;
        this.#sqlite = await sqlite3InitModule({
            locateFile: (path, prefix) => {
                if (path === "sqlite3.wasm") {
                    return SqlitePath;
                }
                return prefix + path;
            },
            print: msg => this.#log(msg),
            printErr: msg => this.#log(msg),
        });
        this.#log(`Got SQLite version: ${this.#sqlite.version.libVersion}`);
        await this.#open(path);
        if (this.db) {
            await migrate(this);
            // dont await to avoid timeout
            runFixers(this);
        }
    }
    /**
     * Open the database from its path
     */
    async #open(path) {
        if (!this.#sqlite)
            throw new Error("Must call init first");
        if (this.db)
            return;
        this.#pool = await this.#sqlite.installOpfsSAHPoolVfs({});
        this.db = new this.#pool.OpfsSAHPoolDb(path);
        this.#log(`Opened ${this.db.filename}`);
        /*this.db.exec(
          `PRAGMA cache_size=${32 * 1024
          }; PRAGMA page_size=8192; PRAGMA journal_mode=MEMORY; PRAGMA temp_store=MEMORY;`,
        );*/
    }
    /**
     * Delete all data
     */
    async wipe() {
        if (this.#pool && this.db) {
            const dbName = this.db.filename;
            this.close();
            await this.#pool.wipeFiles();
            await this.#open(dbName);
            await migrate(this);
        }
    }
    close() {
        this.db?.close();
        this.db = undefined;
    }
    /**
     * Insert an event to the database
     */
    event(ev) {
        if (this.#insertEvent(this.db, ev)) {
            this.#log(`Inserted: kind=${ev.kind},authors=${ev.pubkey},id=${ev.id}`);
            this.emit("event", [ev]);
            return true;
        }
        return false;
    }
    sql(sql, params) {
        return this.db?.selectArrays(sql, params);
    }
    /**
     * Write multiple events
     */
    eventBatch(evs) {
        const start = unixNowMs();
        let eventsInserted = [];
        this.db?.transaction(db => {
            for (const ev of evs) {
                if (this.#insertEvent(db, ev)) {
                    eventsInserted.push(ev);
                }
            }
        });
        if (eventsInserted.length > 0) {
            this.#log(`Inserted Batch: ${eventsInserted.length}/${evs.length}, ${(unixNowMs() - start).toLocaleString()}ms`);
            this.emit("event", eventsInserted);
        }
        return eventsInserted.length > 0;
    }
    setEventMetadata(id, meta) {
        if (meta.seen_at) {
            this.db?.exec("update events set seen_at = ? where id = ?", {
                bind: [meta.seen_at, id],
            });
        }
    }
    #deleteById(db, ids) {
        if (ids.length === 0)
            return;
        db.exec(`delete from events where id in (${this.#repeatParams(ids.length)})`, {
            bind: ids,
        });
        const deleted = db.changes();
        db.exec(`delete from search_content where id in (${this.#repeatParams(ids.length)})`, {
            bind: ids,
        });
        this.#log("Deleted", ids, deleted);
    }
    #insertEvent(db, ev) {
        if (this.#seenInserts.has(ev.id))
            return false;
        const legacyReplacable = [0, 3, 41];
        if (legacyReplacable.includes(ev.kind) || (ev.kind >= 10_000 && ev.kind < 20_000)) {
            const oldEvents = db.selectValues("select id from events where kind = ? and pubkey = ? and created <= ?", [
                ev.kind,
                ev.pubkey,
                ev.created_at,
            ]);
            if (oldEvents.includes(ev.id)) {
                // we already have this event, return
                this.#seenInserts.add(ev.id);
                if (oldEvents.length > 1) {
                    const toDelete = oldEvents.filter(a => a !== ev.id);
                    this.#deleteById(db, toDelete);
                }
                return false;
            }
            else {
                // delete older versions
                this.#deleteById(db, oldEvents);
            }
        }
        if (ev.kind >= 30_000 && ev.kind < 40_000) {
            const dTag = ev.tags.find(a => a[0] === "d")[1];
            const oldEvents = db.selectValues("select id from events where id in (select id from events, tags where events.id = tags.event_id and tags.key = ? and tags.value = ?)", ["d", dTag]);
            if (oldEvents.includes(ev.id)) {
                // we have this version
                this.#seenInserts.add(ev.id);
                if (oldEvents.length > 1) {
                    const toDelete = oldEvents.filter(a => a !== ev.id);
                    this.#deleteById(db, toDelete);
                }
                return false;
            }
            else {
                // delete older versions
                this.#deleteById(db, oldEvents);
            }
        }
        // remove relays from event json
        const evInsert = {
            ...ev,
        };
        delete evInsert["relays"];
        db.exec("insert or ignore into events(id, pubkey, created, kind, json, relays) values(?,?,?,?,?,?)", {
            bind: [ev.id, ev.pubkey, ev.created_at, ev.kind, JSON.stringify(evInsert), (ev.relays ?? []).join(",")],
        });
        const insertedEvents = db.changes();
        if (insertedEvents > 0) {
            for (const t of ev.tags.filter(a => a[0].length === 1)) {
                db.exec("insert into tags(event_id, key, value) values(?, ?, ?)", {
                    bind: [ev.id, t[0], t[1]],
                });
            }
            this.insertIntoSearchIndex(db, ev);
        }
        else {
            this.#updateRelays(db, ev);
            return 0;
        }
        this.#seenInserts.add(ev.id);
        return insertedEvents;
    }
    /**
     * Append relays
     */
    #updateRelays(db, ev) {
        const relays = db.selectArrays("select relays from events where id = ?", [ev.id]);
        const oldRelays = new Set(relays?.at(0)?.at(0)?.split(",") ?? []);
        let hasNew = false;
        for (const r of ev.relays ?? []) {
            if (!oldRelays.has(r)) {
                oldRelays.add(r);
                hasNew = true;
            }
        }
        if (hasNew) {
            db.exec("update events set relays = ? where id = ?", {
                bind: [[...oldRelays].join(","), ev.id],
            });
        }
    }
    /**
     * Query relay by nostr filter
     */
    req(id, req) {
        const start = unixNowMs();
        const [sql, params] = this.#buildQuery(req);
        const res = this.db?.selectArrays(sql, params);
        const results = res?.map(a => {
            if (req.ids_only === true) {
                return a[0];
            }
            const ev = JSON.parse(a[0]);
            return {
                ...ev,
                relays: a[1]?.split(","),
            };
        }) ?? [];
        const time = unixNowMs() - start;
        this.#log(`Query ${id} results took ${time.toLocaleString()}ms`);
        return results;
    }
    /**
     * Count results by nostr filter
     */
    count(req) {
        const start = unixNowMs();
        const [sql, params] = this.#buildQuery(req, true);
        const rows = this.db?.exec(sql, {
            bind: params,
            returnValue: "resultRows",
        });
        const results = rows?.at(0)?.at(0) ?? 0;
        const time = unixNowMs() - start;
        this.#log(`Query count results took ${time.toLocaleString()}ms`);
        return results;
    }
    /**
     * Delete events by nostr filter
     */
    delete(req) {
        this.#log(`Starting delete of ${JSON.stringify(req)}`);
        const start = unixNowMs();
        const for_delete = this.req("ids-for-delete", { ...req, ids_only: true });
        const grouped = for_delete.reduce((acc, v, i) => {
            const batch = (i / 1000).toFixed(0);
            acc[batch] ??= [];
            acc[batch].push(v);
            return acc;
        }, {});
        this.#log(`Starting delete of ${Object.keys(grouped).length} batches`);
        Object.entries(grouped).forEach(([batch, ids]) => {
            this.#deleteById(this.db, ids);
        });
        const time = unixNowMs() - start;
        this.#log(`Delete ${for_delete.length} events took ${time.toLocaleString()}ms`);
        return for_delete;
    }
    /**
     * Get a summary about events table
     */
    summary() {
        const res = this.db?.exec("select kind, count(*) from events group by kind", {
            returnValue: "resultRows",
        });
        return Object.fromEntries(res?.map(a => [String(a[0]), a[1]]) ?? []);
    }
    /**
     * Dump the database file
     */
    async dump() {
        const filePath = String(this.db?.filename ?? "");
        if (this.db && this.#pool) {
            try {
                return await this.#pool.exportFile(`/${filePath}`);
            }
            catch (e) {
                console.error(e);
            }
            finally {
                await this.#open(filePath);
            }
        }
        return new Uint8Array();
    }
    #buildQuery(req, count = false, remove = false) {
        const conditions = [];
        const params = [];
        let resultType = "json,relays";
        if (count) {
            resultType = "count(json)";
        }
        else if (req.ids_only === true) {
            resultType = "id";
        }
        let operation = `select ${resultType}`;
        if (remove) {
            operation = "delete";
        }
        let sql = `${operation} from events`;
        const tags = Object.entries(req).filter(([k]) => k.startsWith("#"));
        let tx = 0;
        for (const [key, values] of tags) {
            const vArray = values;
            sql += ` inner join tags t_${tx} on events.id = t_${tx}.event_id and t_${tx}.key = ? and t_${tx}.value in (${this.#repeatParams(vArray.length)})`;
            params.push(key.slice(1));
            params.push(...vArray);
            tx++;
        }
        if (req.search) {
            sql += " inner join search_content on search_content.id = events.id";
            conditions.push("search_content match ?");
            params.push(req.search.replaceAll(".", "+").replaceAll("@", "+"));
        }
        if (req.ids) {
            conditions.push(`id in (${this.#repeatParams(req.ids.length)})`);
            params.push(...req.ids);
        }
        if (req.authors) {
            conditions.push(`pubkey in (${this.#repeatParams(req.authors.length)})`);
            params.push(...req.authors);
        }
        if (req.kinds) {
            conditions.push(`kind in (${this.#repeatParams(req.kinds.length)})`);
            params.push(...req.kinds);
        }
        if (req.since) {
            conditions.push("created >= ?");
            params.push(req.since);
        }
        if (req.until) {
            conditions.push("created < ?");
            params.push(req.until);
        }
        if (conditions.length > 0) {
            sql += ` where ${conditions.join(" and ")}`;
        }
        if (req.limit) {
            sql += ` order by created desc limit ${req.limit}`;
        }
        return [sql, params];
    }
    #repeatParams(n) {
        const ret = [];
        for (let x = 0; x < n; x++) {
            ret.push("?");
        }
        return ret.join(", ");
    }
    #replaceParamsDebug(sql, params) {
        let res = "";
        let cIdx = 0;
        for (const chr of sql) {
            if (chr === "?") {
                const px = params[cIdx++];
                if (typeof px === "number") {
                    res += px.toString();
                }
                else if (typeof px === "string") {
                    res += `'${px}'`;
                }
            }
            else {
                res += chr;
            }
        }
        return res;
    }
    insertIntoSearchIndex(db, ev) {
        if (ev.kind === 0) {
            const profile = JSON.parse(ev.content);
            if (profile) {
                const indexContent = [
                    profile.name,
                    profile.display_name,
                    profile.about,
                    profile.website,
                    profile.lud16,
                    profile.nip05,
                ].join(" ");
                db.exec("insert into search_content values(?,?)", {
                    bind: [ev.id, indexContent],
                });
            }
        }
        else if (ev.kind === 1) {
            db.exec("insert into search_content values(?,?)", {
                bind: [ev.id, ev.content],
            });
        }
    }
    #fixMissingTags(db) { }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3FsaXRlLXJlbGF5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NxbGl0ZS9zcWxpdGUtcmVsYXkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxpQkFBMkQsTUFBTSx5QkFBeUIsQ0FBQztBQUNsRyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzdDLE9BQU8sRUFBMEUsU0FBUyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQzdHLE9BQU8sT0FBTyxNQUFNLGNBQWMsQ0FBQztBQUNuQyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRXBDLDJGQUEyRjtBQUMzRixPQUFPLFVBQVUsTUFBTSxvQkFBb0IsQ0FBQztBQUM1QyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRXJDLE1BQU0sT0FBTyxXQUFZLFNBQVEsWUFBZ0M7SUFDL0QsT0FBTyxDQUFpQjtJQUN4QixJQUFJLEdBQUcsQ0FBQyxHQUFXLEVBQUUsR0FBRyxJQUFnQixFQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDO0lBQ25GLEVBQUUsQ0FBWTtJQUNkLEtBQUssQ0FBZTtJQUNwQixZQUFZLEdBQUcsSUFBSSxHQUFHLEVBQVUsQ0FBQztJQUVqQzs7T0FFRztJQUNILEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBWTtRQUNyQixJQUFJLElBQUksQ0FBQyxPQUFPO1lBQUUsT0FBTztRQUN6QixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0saUJBQWlCLENBQUM7WUFDckMsVUFBVSxFQUFFLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxFQUFFO2dCQUMzQixJQUFJLElBQUksS0FBSyxjQUFjLEVBQUU7b0JBQzNCLE9BQU8sVUFBVSxDQUFDO2lCQUNuQjtnQkFDRCxPQUFPLE1BQU0sR0FBRyxJQUFJLENBQUM7WUFDdkIsQ0FBQztZQUNELEtB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