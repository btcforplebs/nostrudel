{"version":3,"file":"index.js","sources":["../src/utils/logger.ts","../src/worker/WorkerClient.ts","../src/services/MintService.ts","../src/services/BalanceService.ts","../src/services/LightningService.ts","../src/services/RecoveryService.ts","../src/services/FederationService.ts","../src/FedimintWallet.ts"],"sourcesContent":[null,null,null,null,null,null,null,null],"names":["logLevels","logger","constructor","level","this","setLevel","coerceLevel","includes","toLocaleUpperCase","log","message","args","logLevel","shouldLog","consoleFn","console","toUpperCase","debug","info","warn","error","messageLevel","levels","messageLevelIndex","indexOf","WorkerClient","requestCounter","requestCallbacks","Map","initPromise","undefined","worker","Worker","URL","url","type","onmessage","handleWorkerMessage","bind","onerror","handleWorkerError","initialize","sendSingleMessage","handleWorkerLogs","event","data","requestId","streamCallback","get","payload","Promise","resolve","reject","set","response","delete","postMessage","rpcStream","module","method","body","onSuccess","onError","onEnd","unsubscribe","isSubscribed","unsubscribePromise","setTimeout","_rpcStreamInner","then","end","rpcSingle","cleanup","terminate","clear","_getRequestCounter","_getRequestCallbackMap","MintService","client","redeemEcash","notes","oob_notes","extra_meta","reissueExternalNotes","oobNotes","extraMeta","subscribeReissueExternalNotes","operationId","operation_id","spendNotes","minAmount","tryCancelAfter","includeInvite","duration","nanos","secs","res","min_amount","try_cancel_after","include_invite","parseNotes","tryCancelSpendNotes","subscribeSpendNotes","awaitSpendOobRefund","BalanceService","getBalance","subscribeBalance","parseInt","LightningService","createInvoice","amount","description","expiryTime","gatewayInfo","gateway","_getDefaultGatewayInfo","expiry_time","createInvoiceTweaked","tweakKey","index","user_key","scanReceivesForTweaks","indices","updateGatewayCache","gateways","listGateways","payInvoice","invoice","maybe_gateway","subscribeLnClaim","subscribeLnPay","subscribeLnReceive","waitForReceive","Error","getGateway","gatewayId","forceInternal","gateway_id","force_internal","RecoveryService","hasPendingRecoveries","waitForAllRecoveries","subscribeToRecoveryProgress","FederationService","getConfig","getFederationId","getInviteCode","peer","listOperations","DEFAULT_CLIENT_NAME","FedimintWallet","lazy","_openPromise","_resolveOpen","_isOpen","_client","mint","lightning","balance","federation","recovery","waitForOpen","open","clientName","success","joinFederation","inviteCode","isOpen","setLogLevel"],"mappings":"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"}