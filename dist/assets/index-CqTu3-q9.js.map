{"version":3,"file":"index-CqTu3-q9.js","sources":["../../src/components/icons/clock-rewind.tsx","../../src/views/tools/event-console/history-drawer.tsx","../../src/views/tools/event-console/event-row.tsx","../../src/views/tools/event-console/help-modal.tsx","../../src/views/tools/event-console/schema.ts","../../src/views/tools/event-console/filter-editor.tsx","../../src/views/tools/event-console/index.tsx"],"sourcesContent":["import { createIcon } from \"@chakra-ui/icons\";\n\nconst ClockRewind = createIcon({\n  displayName: \"ClockRewind\",\n  viewBox: \"0 0 24 24\",\n  path: [\n    <path\n      d=\"M22.7 13.5L20.7005 11.5L18.7 13.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C15.3019 3 18.1885 4.77814 19.7545 7.42909M12 7V12L15 14\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n    ></path>,\n  ],\n  defaultProps: { boxSize: 4 },\n});\n\nexport default ClockRewind;\n","import { useRef, useState } from \"react\";\nimport {\n  Button,\n  Drawer,\n  DrawerBody,\n  DrawerCloseButton,\n  DrawerContent,\n  DrawerFooter,\n  DrawerHeader,\n  DrawerOverlay,\n  DrawerProps,\n  Flex,\n  Input,\n} from \"@chakra-ui/react\";\nimport ClockRewind from \"../../../components/icons/clock-rewind\";\nimport { CopyIconButton } from \"../../../components/copy-icon-button\";\n\ntype HistoryDrawerProps = Omit<DrawerProps, \"children\"> & {\n  history: string[];\n  onClear: () => void;\n  onSelect: (item: string) => void;\n};\n\nexport default function HistoryDrawer({ onClose, isOpen, history, onClear, onSelect }: HistoryDrawerProps) {\n  const searchRef = useRef<HTMLInputElement | null>(null);\n  const [search, setSearch] = useState(\"\");\n\n  const filteredHistory = search.length > 1 ? history.filter((query) => query.includes(search)) : history;\n\n  return (\n    <Drawer isOpen={isOpen} placement=\"right\" onClose={onClose} initialFocusRef={searchRef} size=\"md\">\n      <DrawerOverlay />\n      <DrawerContent>\n        <DrawerCloseButton />\n        <DrawerHeader px=\"2\" pt=\"2\" pb=\"0\">\n          <ClockRewind boxSize=\"6\" /> History\n        </DrawerHeader>\n\n        <DrawerBody p=\"2\" overflowX=\"hidden\" overflowY=\"auto\">\n          <Input\n            placeholder=\"Search\"\n            type=\"search\"\n            ref={searchRef}\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n          />\n\n          <Flex direction=\"column\" gap=\"2\" mt=\"2\">\n            {filteredHistory.map((query) => (\n              <Flex key={query} gap=\"2\" alignItems=\"center\">\n                <Button\n                  variant=\"ghost\"\n                  fontFamily=\"monospace\"\n                  fontWeight=\"normal\"\n                  fontSize=\"xs\"\n                  size=\"sm\"\n                  w=\"full\"\n                  justifyContent=\"flex-start\"\n                  onClick={() => onSelect(query)}\n                >\n                  {query}\n                </Button>\n                <CopyIconButton\n                  value={query}\n                  aria-label=\"Copy Filter\"\n                  title=\"Copy Filter\"\n                  size=\"xs\"\n                  ml=\"auto\"\n                  tabIndex={-1}\n                />\n              </Flex>\n            ))}\n          </Flex>\n        </DrawerBody>\n\n        <DrawerFooter p=\"2\">\n          <Button variant=\"outline\" onClick={onClear}>\n            Clear\n          </Button>\n        </DrawerFooter>\n      </DrawerContent>\n    </Drawer>\n  );\n}\n","import { Box, Code, Flex, Heading, Switch, Text, useDisclosure } from \"@chakra-ui/react\";\nimport { NostrEvent } from \"nostr-tools\";\nimport ExpandButton from \"./expand-button\";\nimport UserName from \"../../../components/user/user-name\";\nimport { CopyIconButton } from \"../../../components/copy-icon-button\";\nimport Timestamp from \"../../../components/timestamp\";\nimport stringify from \"json-stringify-deterministic\";\n\nexport default function EventRow({ event }: { event: NostrEvent }) {\n  const expanded = useDisclosure();\n  const raw = useDisclosure();\n\n  return (\n    <>\n      <Flex\n        gap=\"2\"\n        alignItems=\"center\"\n        borderTopWidth={1}\n        p=\"2\"\n        onClick={expanded.onToggle}\n        overflow=\"hidden\"\n        cursor=\"pointer\"\n      >\n        <Text fontFamily=\"monospace\" whiteSpace=\"pre\">\n          {event.id.slice(0, 8)} ({event.kind}) [{event.tags.length}]\n        </Text>\n        <UserName pubkey={event.pubkey} fontSize=\"sm\" />\n        {!expanded.isOpen && (\n          <Text isTruncated fontSize=\"sm\">\n            {event.content}\n          </Text>\n        )}\n        <ExpandButton isOpen={expanded.isOpen} onToggle={expanded.onToggle} size=\"xs\" variant=\"ghost\" ml=\"auto\" />\n      </Flex>\n\n      {expanded.isOpen && (\n        <Flex gap=\"2\" direction=\"column\" px=\"2\" pb=\"2\" alignItems=\"flex-start\" position=\"relative\">\n          <Flex\n            top=\"2\"\n            right=\"4\"\n            position=\"absolute\"\n            gap=\"2\"\n            alignItems=\"center\"\n            p=\"2\"\n            bg=\"var(--chakra-colors-chakra-body-bg)\"\n            borderRadius=\"md\"\n          >\n            {raw.isOpen && (\n              <CopyIconButton value={stringify(event, { space: \"  \" })} aria-label=\"Copy json\" size=\"sm\" />\n            )}\n            <Switch size=\"sm\" isChecked={!raw.isOpen} onChange={raw.onToggle}>\n              Raw\n            </Switch>\n          </Flex>\n          {raw.isOpen ? (\n            <Code whiteSpace=\"pre\" w=\"full\" overflow=\"auto\">\n              {stringify(event, { space: \"  \" })}\n            </Code>\n          ) : (\n            <>\n              <Flex gap=\"2\">\n                <Text>ID: </Text>\n                <Code>{event.id}</Code>\n                <CopyIconButton value={event.id} aria-label=\"Copy ID\" title=\"Copy ID\" size=\"xs\" />\n              </Flex>\n              <Flex gap=\"2\">\n                <Text>Pubkey: </Text>\n                <Code>{event.pubkey}</Code>\n                <CopyIconButton value={event.pubkey} aria-label=\"Copy Pubkey\" title=\"Copy Pubkey\" size=\"xs\" />\n              </Flex>\n              <Flex gap=\"2\">\n                <Text>Created: </Text>\n                <Code>{event.created_at}</Code>\n                <Timestamp timestamp={event.created_at} />\n              </Flex>\n              <Code whiteSpace=\"pre-wrap\" w=\"full\">\n                {event.content}\n              </Code>\n              <Box>\n                <Text>Tags:</Text>\n                <Flex gap=\"2\" direction=\"column\">\n                  {event.tags.map((t, i) => (\n                    <Flex key={t.join(\",\") + i} gap=\"1\" wrap=\"wrap\">\n                      {t.map((v, ii) => (\n                        <Code key={v} minW=\"1rem\" fontFamily=\"monospace\" fontWeight={ii === 0 ? \"bold\" : \"normal\"}>\n                          {v}\n                        </Code>\n                      ))}\n                    </Flex>\n                  ))}\n                </Flex>\n              </Box>\n            </>\n          )}\n        </Flex>\n      )}\n    </>\n  );\n}\n","import {\n  Code,\n  Flex,\n  Heading,\n  Modal,\n  ModalBody,\n  ModalCloseButton,\n  ModalContent,\n  ModalHeader,\n  ModalOverlay,\n  ModalProps,\n  Text,\n} from \"@chakra-ui/react\";\n\nexport default function HelpModal({ isOpen, onClose, ...props }: Omit<ModalProps, \"children\">) {\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} size=\"lg\" {...props}>\n      <ModalOverlay />\n      <ModalContent>\n        <ModalHeader p=\"4\">Help</ModalHeader>\n        <ModalCloseButton />\n        <ModalBody px=\"4\" pt=\"0\" pb=\"4\">\n          <Heading size=\"sm\">Keyboard shortcuts</Heading>\n          <Text>\n            <Code>Ctrl+Shift+Enter</Code>: Run Filter\n          </Text>\n\n          <Heading size=\"sm\" mt=\"4\">\n            Pubkeys\n          </Heading>\n          <Text>\n            Typing <Code>@</Code> inside any string will autocomplete with a list of users the app has seen\n          </Text>\n\n          <Heading size=\"sm\" mt=\"4\">\n            Dates\n          </Heading>\n          <Text>\n            <Code>since</Code> and <Code>until</Code> fields can both take relative times in the form of strings\n          </Text>\n          <Text>Examples:</Text>\n          <Flex gap=\"1\">\n            {[\"now\", \"n-3h\", \"n-5\", \"n+4m\", \"n-7d\", \"n-30s\", \"n-4w\"].map((t) => (\n              <Code key={t}>{t}</Code>\n            ))}\n          </Flex>\n        </ModalBody>\n      </ModalContent>\n    </Modal>\n  );\n}\n","import { type JSONSchema7 } from \"json-schema\";\nimport { kinds } from \"nostr-tools\";\n\nconst kindNumbers = Object.values(kinds).filter((t) => typeof t === \"number\") as number[];\n\nconst letters = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".split(\"\");\nexport const NostrFilterSchema: JSONSchema7 = {\n  type: \"object\",\n  properties: {\n    ids: {\n      type: \"array\",\n      minItems: 1,\n      uniqueItems: true,\n      items: {\n        type: \"string\",\n      },\n    },\n    kinds: {\n      type: \"array\",\n      description: \"Filter by event kind\",\n      minItems: 1,\n      uniqueItems: true,\n      items: {\n        type: \"integer\",\n        minimum: 0,\n        examples: kindNumbers,\n      },\n    },\n    authors: {\n      type: \"array\",\n      description: \"Filter by pubkey\",\n      minItems: 1,\n      uniqueItems: true,\n      items: {\n        type: \"string\",\n      },\n    },\n    limit: {\n      type: \"integer\",\n      description: \"max number of events to return\",\n      default: 20,\n      minimum: 0,\n    },\n    until: {\n      description: \"Return events before or on this date\",\n      oneOf: [\n        {\n          type: \"integer\",\n          minimum: 0,\n        },\n        { type: \"string\" },\n      ],\n    },\n    since: {\n      description: \"Return events after or on this date\",\n      oneOf: [\n        {\n          type: \"integer\",\n          minimum: 0,\n        },\n        { type: \"string\" },\n      ],\n    },\n  },\n};\n\nfor (const letter of letters) {\n  NostrFilterSchema.properties![\"#\" + letter] = {\n    type: \"array\",\n    description: `Filter on ${letter} tag`,\n    items: {\n      type: \"string\",\n    },\n  };\n}\n","import { memo, useMemo } from \"react\";\nimport { useColorMode } from \"@chakra-ui/react\";\nimport ReactCodeMirror from \"@uiw/react-codemirror\";\nimport { githubLight, githubDark } from \"@uiw/codemirror-theme-github\";\nimport { jsonSchema } from \"codemirror-json-schema\";\nimport { keymap } from \"@codemirror/view\";\nimport { useInterval } from \"react-use\";\nimport _throttle from \"lodash.throttle\";\nimport { CompletionContext, CompletionResult } from \"@codemirror/autocomplete\";\nimport { jsonLanguage } from \"@codemirror/lang-json\";\nimport { syntaxTree } from \"@codemirror/language\";\n\nimport { NostrFilterSchema } from \"./schema\";\nimport { UserDirectory, useUserSearchDirectoryContext } from \"../../../providers/global/user-directory-provider\";\nimport { codeMirrorUserAutocomplete, updateCodeMirrorUserAutocomplete } from \"./user-autocomplete\";\n\nconst FilterEditor = memo(\n  ({ value, onChange, onRun }: { value: string; onChange: (v: string) => void; onRun: () => void }) => {\n    const getDirectory = useUserSearchDirectoryContext();\n    const { colorMode } = useColorMode();\n\n    useInterval(() => {\n      updateCodeMirrorUserAutocomplete(getDirectory());\n    }, 1000);\n\n    const extensions = useMemo(\n      () => [\n        keymap.of([\n          {\n            win: \"Ctrl-Enter\",\n            linux: \"Ctrl-Enter\",\n            mac: \"Cmd-Enter\",\n            preventDefault: true,\n            run: () => {\n              onRun();\n              return true;\n            },\n            shift: () => {\n              onRun();\n              return true;\n            },\n          },\n        ]),\n        jsonSchema(NostrFilterSchema),\n        jsonLanguage.data.of({\n          autocomplete: codeMirrorUserAutocomplete,\n        }),\n      ],\n      [onRun],\n    );\n    return (\n      <ReactCodeMirror\n        value={value}\n        onChange={onChange}\n        height=\"200px\"\n        lang=\"json\"\n        extensions={extensions}\n        theme={colorMode === \"light\" ? githubLight : githubDark}\n      />\n    );\n  },\n);\n\nexport default FilterEditor;\n","import { memo, useCallback, useRef, useState } from \"react\";\nimport {\n  Alert,\n  AlertDescription,\n  AlertIcon,\n  AlertTitle,\n  Box,\n  Button,\n  ButtonGroup,\n  CloseButton,\n  Flex,\n  Heading,\n  IconButton,\n  Switch,\n  Text,\n  useDisclosure,\n} from \"@chakra-ui/react\";\nimport { NostrEvent } from \"nostr-tools\";\nimport { AbstractRelay, Subscription } from \"nostr-tools/abstract-relay\";\nimport { useLocalStorage } from \"react-use\";\nimport { Subscription as IDBSubscription } from \"nostr-idb\";\nimport _throttle from \"lodash.throttle\";\nimport stringify from \"json-stringify-deterministic\";\nimport { useSearchParams } from \"react-router-dom\";\n\nimport VerticalPageLayout from \"../../../components/vertical-page-layout\";\nimport BackButton from \"../../../components/router/back-button\";\nimport { localRelay } from \"../../../services/local-relay\";\nimport Play from \"../../../components/icons/play\";\nimport ClockRewind from \"../../../components/icons/clock-rewind\";\nimport HistoryDrawer from \"./history-drawer\";\nimport EventRow from \"./event-row\";\nimport { processFilter } from \"./process\";\nimport HelpModal from \"./help-modal\";\nimport HelpCircle from \"../../../components/icons/help-circle\";\nimport { DownloadIcon, ShareIcon } from \"../../../components/icons\";\nimport { RelayUrlInput } from \"../../../components/relay-url-input\";\nimport { validateRelayURL } from \"../../../helpers/relay\";\nimport FilterEditor from \"./filter-editor\";\nimport { safeJson } from \"../../../helpers/parse\";\nimport relayPoolService from \"../../../services/relay-pool\";\n\nconst EventTimeline = memo(({ events }: { events: NostrEvent[] }) => {\n  return (\n    <>\n      {events.map((event) => (\n        <EventRow key={event.id} event={event} />\n      ))}\n    </>\n  );\n});\n\nexport default function EventConsoleView() {\n  const [params, setParams] = useSearchParams();\n  const historyDrawer = useDisclosure();\n  const [history, setHistory] = useLocalStorage<string[]>(\"console-history\", []);\n  const helpModal = useDisclosure();\n  const queryRelay = useDisclosure({ defaultIsOpen: params.has(\"relay\") });\n  const [relayURL, setRelayURL] = useState(params.get(\"relay\") || \"\");\n  const [relay, setRelay] = useState<AbstractRelay | null>(null);\n\n  const [sub, setSub] = useState<Subscription | IDBSubscription | null>(null);\n\n  const [query, setQuery] = useState(() => {\n    if (params.has(\"filter\")) {\n      const str = params.get(\"filter\");\n      if (str) {\n        const f = safeJson(str, null);\n        if (f) return JSON.stringify(f, null, 2);\n      }\n    }\n    if (history?.[0]) return history?.[0];\n    return JSON.stringify({ kinds: [1], limit: 20 }, null, 2);\n  });\n\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [events, setEvents] = useState<NostrEvent[]>([]);\n  const loadEvents = useCallback(async () => {\n    try {\n      if (queryRelay.isOpen && !relayURL) throw new Error(\"Must set relay\");\n\n      const filter = await processFilter(JSON.parse(query));\n      setLoading(true);\n      setHistory((arr) => (arr ? (!arr.includes(query) ? [query, ...arr] : arr) : [query]));\n      setEvents([]);\n\n      if (sub) sub.close();\n\n      if (!localRelay) throw new Error(\"Local relay disabled\");\n      let r = localRelay!;\n      if (queryRelay.isOpen) {\n        const url = validateRelayURL(relayURL);\n        if (!relay || relay.url !== url.toString()) {\n          r = await relayPoolService.requestRelay(url);\n          await relayPoolService.requestConnect(r);\n          setRelay(r as AbstractRelay);\n        } else r = relay;\n      } else {\n        if (relay) setRelay(null);\n      }\n\n      await new Promise<void>((res) => {\n        let buffer: NostrEvent[] = [];\n        const flush = _throttle(() => setEvents([...buffer]), 1000 / 10, { trailing: true });\n\n        setError(\"\");\n\n        const s = r.subscribe([filter], {\n          onevent: (e) => {\n            buffer.push(e);\n            flush();\n          },\n          oneose: () => {\n            setEvents([...buffer]);\n            res();\n          },\n          onclose: (reason) => {\n            if (!buffer.length) setError(reason);\n          },\n        });\n        setSub(s);\n      });\n    } catch (e) {\n      if (e instanceof Error) setError(e.message);\n    }\n    setLoading(false);\n  }, [queryRelay.isOpen, query, relayURL, relay, sub]);\n\n  const submitRef = useRef(loadEvents);\n  submitRef.current = loadEvents;\n\n  const submitCode = useCallback(() => submitRef.current(), []);\n\n  const downloadEvents = () => {\n    const lines = events.map((e) => stringify(e)).join(\"\\n\");\n    const file = new File([lines], \"events.json\", { type: \"application/jsonl\" });\n    const url = URL.createObjectURL(file);\n    window.open(url, \"_blank\");\n  };\n\n  const updateSharedURL = () => {\n    const p = new URLSearchParams(params);\n    p.set(\"filter\", query);\n    p.set(\"relay\", relayURL);\n    setParams(p, { replace: true });\n  };\n\n  return (\n    <VerticalPageLayout>\n      <Flex gap=\"2\" alignItems=\"center\" wrap=\"wrap\">\n        <BackButton size=\"sm\" />\n        <Heading size=\"md\">Event Console</Heading>\n        <Switch size=\"sm\" isChecked={queryRelay.isOpen} onChange={queryRelay.onToggle}>\n          Query Relay\n        </Switch>\n        {queryRelay.isOpen && (\n          <RelayUrlInput\n            size=\"sm\"\n            borderRadius=\"md\"\n            w=\"xs\"\n            value={relayURL}\n            onChange={(e) => setRelayURL(e.target.value)}\n          />\n        )}\n        <ButtonGroup ml=\"auto\">\n          <IconButton icon={<HelpCircle />} aria-label=\"Help\" title=\"Help\" size=\"sm\" onClick={helpModal.onOpen} />\n          {queryRelay.isOpen && (\n            <IconButton icon={<ShareIcon />} aria-label=\"Share\" size=\"sm\" onClick={updateSharedURL} />\n          )}\n          <IconButton\n            icon={<ClockRewind />}\n            aria-label=\"History\"\n            title=\"History\"\n            size=\"sm\"\n            onClick={historyDrawer.onOpen}\n          />\n          <Button colorScheme=\"primary\" onClick={loadEvents} isLoading={loading} leftIcon={<Play />} size=\"sm\">\n            Run\n          </Button>\n        </ButtonGroup>\n      </Flex>\n\n      <FilterEditor value={query} onChange={setQuery} onRun={submitCode} />\n\n      {error && (\n        <Alert status=\"error\">\n          <AlertIcon />\n          <Box>\n            <AlertTitle>Error</AlertTitle>\n            <AlertDescription whiteSpace=\"pre\">{error}</AlertDescription>\n          </Box>\n          <CloseButton\n            alignSelf=\"flex-start\"\n            position=\"relative\"\n            right={-1}\n            top={-1}\n            onClick={() => setError(\"\")}\n            ml=\"auto\"\n          />\n        </Alert>\n      )}\n\n      <Flex gap=\"2\">\n        <Text>{events.length} events</Text>\n        {sub && (\n          <Text color=\"green.500\" ml=\"auto\">\n            Subscribed\n          </Text>\n        )}\n        {events.length > 0 && (\n          <IconButton\n            aria-label=\"Download Events\"\n            title=\"Download Events\"\n            icon={<DownloadIcon />}\n            onClick={downloadEvents}\n            size=\"xs\"\n          />\n        )}\n      </Flex>\n      <Box>\n        <EventTimeline events={events} />\n      </Box>\n\n      <HistoryDrawer\n        isOpen={historyDrawer.isOpen}\n        onClose={historyDrawer.onClose}\n        history={history || []}\n        onClear={() => setHistory([])}\n        onSelect={(v) => {\n          setQuery(v);\n          historyDrawer.onClose();\n        }}\n      />\n\n      <HelpModal isOpen={helpModal.isOpen} onClose={helpModal.onClose} />\n    </VerticalPageLayout>\n  );\n}\n"],"names":["ClockRewind","createIcon","jsx","HistoryDrawer","onClose","isOpen","history","onClear","onSelect","searchRef","useRef","search","setSearch","useState","filteredHistory","query","jsxs","Drawer","DrawerOverlay","DrawerContent","DrawerCloseButton","DrawerHeader","DrawerBody","Input","e","Flex","Button","CopyIconButton","DrawerFooter","EventRow","event","expanded","useDisclosure","raw","Fragment","Text","UserName","ExpandButton","stringify","Switch","Code","Timestamp","Box","t","i","v","ii","HelpModal","props","Modal","ModalOverlay","ModalContent","ModalHeader","ModalCloseButton","ModalBody","Heading","kindNumbers","kinds","letters","NostrFilterSchema","letter","FilterEditor","memo","value","onChange","onRun","getDirectory","useUserSearchDirectoryContext","colorMode","useColorMode","useInterval","updateCodeMirrorUserAutocomplete","extensions","useMemo","keymap","jsonSchema","jsonLanguage","codeMirrorUserAutocomplete","ReactCodeMirror","githubLight","githubDark","EventTimeline","events","EventConsoleView","params","setParams","useSearchParams","historyDrawer","setHistory","useLocalStorage","helpModal","queryRelay","relayURL","setRelayURL","relay","setRelay","sub","setSub","setQuery","str","f","safeJson","error","setError","loading","setLoading","setEvents","loadEvents","useCallback","filter","processFilter","arr","localRelay","r","url","validateRelayURL","relayPoolService","res","buffer","flush","_throttle","s","reason","submitRef","submitCode","downloadEvents","lines","file","updateSharedURL","p","VerticalPageLayout","BackButton","RelayUrlInput","ButtonGroup","IconButton","HelpCircle","ShareIcon","Play","Alert","AlertIcon","AlertTitle","AlertDescription","CloseButton","DownloadIcon"],"mappings":"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"}