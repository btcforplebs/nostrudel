import{af as k,j as e,aE as p,bp as C,at as F,hv as y,_ as V,ct as I,dx as R,a6 as T,ae as q,hE as A,bI as L,hD as B,hC as W,bJ as _,hQ as D,hR as g,hz as H,hw as K,cm as N,V as M,H as O,F as j,cn as u,co as l,v as f,dB as z,aP as G,E as b}from"./index-C6wlVu-O.js";import{F as J,M as Q}from"./format-toolbar-CPmampgE.js";function Y({page:t}){const r=R(),n=T(),d=q(),i=A(t),{register:o,setValue:m,getValues:c,handleSubmit:E,watch:P,formState:h,reset:S}=L({defaultValues:{content:t.content,title:B(t)??i,summary:W(t,!1)},mode:"all"}),v=_("wiki-"+i,c,S,h);P("content"),o("content",{minLength:10,required:!0});const w=E(async s=>{try{const a=D(y,t);a.content=s.content,g(a,"title",s.title),g(a,"summary",s.summary);const x=await n("Publish Page",a,H,!1);K.handleEvent(x.event),v(),d(`/wiki/page/${N.getSharableEventAddress(x.event)}`,{replace:!0})}catch(a){a instanceof Error&&r({description:a.message,status:"error"})}});return e.jsxs(M,{as:"form",h:"full",onSubmit:w,children:[e.jsx(O,{children:"Edit Page"}),e.jsxs(j,{gap:"2",wrap:{base:"wrap",md:"nowrap"},children:[e.jsxs(u,{w:{base:"full",md:"sm"},isRequired:!0,flexShrink:0,children:[e.jsx(l,{children:"Topic"}),e.jsx(f,{readOnly:!0,value:i})]}),e.jsxs(u,{isRequired:!0,children:[e.jsx(l,{children:"Title"}),e.jsx(f,{...o("title",{required:!0}),autoComplete:"off"})]})]}),e.jsxs(u,{children:[e.jsx(l,{children:"Summary"}),e.jsx(z,{...o("summary",{required:!0}),isRequired:!0})]}),e.jsxs(j,{gap:"2",children:[e.jsx(J,{getValue:()=>c().content,setValue:s=>m("content",s,{shouldDirty:!0})}),e.jsx(G,{}),e.jsx(b,{onClick:()=>d(-1),children:"Cancel"}),e.jsx(b,{colorScheme:"primary",type:"submit",isLoading:h.isSubmitting,children:"Publish"})]}),e.jsx(Q,{value:c().content,onChange:s=>m("content",s)})]})}function X(){const t=k();if(!t)return e.jsx(p,{to:"/"});const r=C().topic;if(!r)return e.jsx(p,{to:"/wiki"});const n=F({kind:y,pubkey:t.pubkey,identifier:r});return n?e.jsx(I,{children:e.jsx(Y,{page:n})}):e.jsx(V,{})}export{X as default};
//# sourceMappingURL=edit-UFkPthm5.js.map
