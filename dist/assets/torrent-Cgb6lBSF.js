import{j as e,cQ as K,cR as Q,dK as Z,cS as q,ea as G,dM as X,cV as J,r as y,bS as Y,s as h,aI as $,h9 as ee,F as i,aN as w,Z as O,bD as se,aX as S,E as x,fq as T,ha as f,z as b,hb as ne,hc as ae,y as p,eL as te,cd as R,aP as re,hd as ie,u as le,he as E,hf as m,hg as F,e as oe,hh as ce,h2 as de,hi as xe,i as ue,I as je,gi as he,fB as L,a2 as pe,a3 as me,n as ge,cx as ve,cy as Ce,_ as ye,ct as Te,hj as fe,V as be,H as d,T as o,ev as ke,C as j,ew as Ie,cg as Me,ce as ze,l as we,ex as Oe,et as Se,c0 as Re,c1 as Ee,c2 as Fe,c3 as k,c4 as I,c5 as Le,eu as M,hk as Be}from"./index-C6wlVu-O.js";import{f as z}from"./number-BsCqcFD4.js";import{T as De}from"./torrent-menu-DLKj8E4u.js";function Ne({comment:s,...a}){return e.jsx(e.Fragment,{children:e.jsxs(K,{...a,children:[e.jsx(Q,{event:s}),e.jsx(Z,{event:s}),e.jsx(q,{event:s}),e.jsx(G,{event:s}),e.jsx(X,{event:s}),e.jsx(J,{event:s})]})})}const B=y.memo(({post:s,level:a=-1})=>{const{showReactions:t}=Y(),n=h({defaultIsOpen:a<2||s.replies.size<=1}),r=h(),l=$(),u=Array.from(s.replies).filter(c=>!l(c.event)),D=ee(u),g=l(s.event),[N,P]=y.useState(!1),A=e.jsxs(pe,{status:"warning",children:[e.jsx(me,{}),"Muted user or note",e.jsx(x,{size:"xs",ml:"auto",onClick:()=>P(!0),children:"Show anyway"})]});if(g&&u.length===0)return null;const _=e.jsxs(i,{gap:"2",alignItems:"center",children:[e.jsx(w,{pubkey:s.event.pubkey,size:"sm"}),e.jsx(O,{pubkey:s.event.pubkey,fontWeight:"bold",isTruncated:!0}),e.jsx(se,{pubkey:s.event.pubkey,onlyIcon:!0}),e.jsx(S,{timestamp:s.event.created_at}),u.length>0?e.jsxs(x,{variant:"ghost",onClick:n.onToggle,rightIcon:n.isOpen?e.jsx(T,{}):e.jsx(f,{}),children:["(",D,")"]}):e.jsx(b,{variant:"ghost",onClick:n.onToggle,icon:n.isOpen?e.jsx(T,{}):e.jsx(f,{}),"aria-label":n.isOpen?"Collapse":"Expand",title:n.isOpen?"Collapse":"Expand"})]}),U=()=>g&&!N?A:e.jsx(e.Fragment,{children:e.jsx(he,{event:s.event,children:e.jsx(L,{event:s.event,pl:"2"})})}),v=ne({base:!0,lg:!1}),C=t&&e.jsx(ae,{event:s.event,flexWrap:"wrap",variant:"ghost",size:"sm"}),V=e.jsxs(i,{gap:"2",alignItems:"center",children:[e.jsxs(p,{variant:"ghost",size:"sm",children:[e.jsx(b,{"aria-label":"Reply",title:"Reply",onClick:r.onToggle,icon:e.jsx(te,{})}),e.jsx(R,{event:s.event})]}),!v&&C,e.jsx(re,{}),e.jsx(p,{size:"sm",variant:"ghost",children:e.jsx(Ne,{comment:s.event,"aria-label":"More Options"})})]}),W=ie(a),H=le(s.event);return e.jsxs(e.Fragment,{children:[e.jsxs(i,{direction:"column",gap:"2",p:"2",borderRadius:"md",borderWidth:".1rem .1rem .1rem .35rem",...W,ref:H,children:[_,n.isOpen&&U(),n.isOpen&&v&&C,n.isOpen&&V]}),r.isOpen&&e.jsx(E,{item:s,onCancel:r.onClose,onSubmitted:r.onClose,replyKind:m}),s.replies.size>0&&n.isOpen&&e.jsx(i,{direction:"column",gap:"2",pl:{base:2,md:4},children:F(s).map(c=>e.jsx(B,{post:c,level:a+1},c.event.id))})]})});function Pe({torrent:s}){const a=oe(),{timeline:t}=ce(s,a,[m]),n=de(xe,[s.id]),r=ue(t);return e.jsx(je,{callback:r,children:(n==null?void 0:n.root)&&F(n.root).map(l=>e.jsx(B,{post:l,level:0},l.event.id))})}const Ae=ge({displayName:"MessageTextCircle01",viewBox:"0 0 24 24",path:[e.jsx("path",{d:"M7.99962 9.5H11.9996M7.99962 13H14.9996M12.4996 20C17.194 20 20.9996 16.1944 20.9996 11.5C20.9996 6.80558 17.194 3 12.4996 3C7.8052 3 3.99962 6.80558 3.99962 11.5C3.99962 12.45 4.15547 13.3636 4.443 14.2166C4.55119 14.5376 4.60529 14.6981 4.61505 14.8214C4.62469 14.9432 4.6174 15.0286 4.58728 15.1469C4.55677 15.2668 4.48942 15.3915 4.35472 15.6408L2.71906 18.6684C2.48575 19.1002 2.36909 19.3161 2.3952 19.4828C2.41794 19.6279 2.50337 19.7557 2.6288 19.8322C2.7728 19.9201 3.01692 19.8948 3.50517 19.8444L8.62619 19.315C8.78127 19.299 8.85881 19.291 8.92949 19.2937C8.999 19.2963 9.04807 19.3029 9.11586 19.3185C9.18478 19.3344 9.27145 19.3678 9.44478 19.4345C10.3928 19.7998 11.4228 20 12.4996 20Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})],defaultProps:{boxSize:4}});function _e({torrent:s}){const a=fe(s),t=h();return e.jsxs(be,{children:[e.jsxs(i,{gap:"2",alignItems:"center",wrap:"wrap",children:[e.jsxs(i,{as:d,size:"md",gap:"2",alignItems:"center",wrap:"wrap",children:[e.jsx(w,{pubkey:s.pubkey,size:"md"}),e.jsx(O,{pubkey:s.pubkey,fontWeight:"bold"}),e.jsx(o,{children:" - "}),e.jsx(o,{children:ke(s)})]}),e.jsx(De,{torrent:s,ml:"auto","aria-label":"More Options"})]}),e.jsxs(j,{p:"2",display:"flex",gap:"2",flexDirection:"column",alignItems:"flex-start",children:[e.jsxs(o,{children:["Size: ",z(Ie(s))]}),e.jsxs(o,{children:["Uploaded: ",e.jsx(S,{timestamp:s.created_at})]}),e.jsxs(i,{gap:"2",children:[e.jsx(o,{children:"Tags:"}),s.tags.filter(n=>n[0]==="t").map(([n,r])=>e.jsx(Me,{children:r},r))]}),e.jsxs(p,{variant:"ghost",size:"sm",children:[e.jsx(R,{event:s}),e.jsx(ze,{event:s}),e.jsx(x,{as:we,leftIcon:e.jsx(Oe,{boxSize:5}),href:Se(s),isExternal:!0,children:"Download torrent"})]})]}),s.content.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"md",mt:"2",children:"Description"}),e.jsx(j,{p:"2",children:e.jsx(L,{event:s})})]}),e.jsx(d,{size:"md",mt:"2",children:"Files"}),e.jsx(j,{p:"2",children:e.jsx(Re,{children:e.jsxs(Ee,{size:"sm",children:[e.jsx(Fe,{children:e.jsxs(k,{children:[e.jsx(I,{children:"Filename"}),e.jsx(I,{children:"Size"})]})}),e.jsx(Le,{children:a.map(n=>e.jsxs(k,{children:[e.jsx(M,{children:n.name}),e.jsx(M,{children:z(n.size??0)})]},n.name))})]})})}),e.jsxs(i,{gap:"2",children:[e.jsx(d,{size:"md",mt:"2",children:"Comments"}),!t.isOpen&&e.jsx(x,{leftIcon:e.jsx(Ae,{}),size:"sm",ml:"auto",onClick:t.onOpen,children:"New Comment"})]}),t.isOpen&&e.jsx(E,{item:{event:s,refs:Be(s),replies:new Set},onCancel:t.onClose,onSubmitted:t.onClose,replyKind:m}),e.jsx(Pe,{torrent:s})]})}function He(){const s=ve("id"),a=Ce(s==null?void 0:s.id,(s==null?void 0:s.relays)??[]);return a?e.jsx(Te,{children:e.jsx(_e,{torrent:a})}):e.jsx(ye,{})}export{He as default};
//# sourceMappingURL=torrent-Cgb6lBSF.js.map
