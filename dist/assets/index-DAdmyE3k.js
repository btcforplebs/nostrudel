import{aA as k,dT as C,af as E,ay as L,r as p,j as e,F as h,aB as T,aC as U,T as o,E as l,H as x,S as y,y as R,dU as c,aG as A,aM as B,b as v,dV as F,l as W,a2 as q,a3 as G}from"./index-C6wlVu-O.js";import{w as r}from"./webrtc-relays-BQTG2acl.js";function P({call:s,peer:d,client:a,server:u}){var f;const t=k();C(t,1e3);const n=E(),b=L(n==null?void 0:n.pubkey),[w,j]=p.useState(!1),S=async()=>{if(!(n!=null&&n.pubkey)||!c)return;j(!0);const m=c.subscribe([{authors:[n.pubkey]}],{onevent:i=>{a.publish(i),t()},oneose:()=>{m.close(),j(!1)}})},[z,g]=p.useState(!1),I=async()=>{if(!b||!c)return;g(!0);const m=a.subscribe([{authors:A(b).map(i=>i.pubkey)}],{onevent:i=>{c&&c.publish(i),t()},oneose:()=>{m.close(),g(!1)}})};return e.jsxs(h,{borderWidth:"1px",rounded:"md",p:"2",gap:"2",direction:"column",children:[e.jsxs(h,{gap:"2",alignItems:"center",children:[e.jsx(T,{pubkey:s.pubkey,size:"sm"}),e.jsx(U,{pubkey:s.pubkey}),e.jsx(o,{children:((f=d.connection)==null?void 0:f.connectionState)??"Unknown"}),e.jsx(l,{size:"sm",ml:"auto",colorScheme:"red",isDisabled:!0,children:"Close"})]}),e.jsx(x,{size:"sm",children:"Server:"}),e.jsxs(y,{spacing:"2",columns:{base:2,md:3,lg:4,xl:5},children:[e.jsxs(o,{children:["Sent: ",u.stats.events.sent]}),e.jsxs(o,{children:["Received: ",u.stats.events.received]})]}),e.jsx(x,{size:"sm",children:"Client:"}),e.jsxs(y,{spacing:"2",columns:{base:2,md:3,lg:4,xl:5},children:[e.jsxs(o,{children:["Published: ",a.stats.events.published]}),e.jsxs(o,{children:["Received: ",a.stats.events.received]})]}),n&&e.jsxs(R,{ml:"auto",size:"sm",children:[e.jsx(l,{onClick:S,isLoading:w,children:"Send events"}),e.jsx(l,{onClick:I,isLoading:z,children:"Requests contacts"})]})]},s.id)}function V(){const s=k();C(s,1e3),p.useEffect(()=>(r.broker.on("call",s),()=>{r.broker.off("call",s)}),[s]);const d=r.pendingIncoming.length;return e.jsxs(h,{gap:"2",direction:"column",overflow:"auto hidden",flex:1,px:{base:"2",lg:0},children:[e.jsxs(h,{gap:"2",alignItems:"center",wrap:"wrap",children:[e.jsx(B,{hideFrom:"lg",size:"sm"}),e.jsx(x,{size:"lg",children:"WebRTC Relays"}),e.jsxs(R,{size:"sm",ml:"auto",children:[e.jsxs(l,{as:v,to:"/relays/webrtc/pair",leftIcon:e.jsx(F,{}),children:["Pair",d>0?` (${d})`:""]}),e.jsx(l,{as:v,to:"/relays/webrtc/connect",colorScheme:"primary",children:"Connect"})]})]}),e.jsxs(o,{fontStyle:"italic",mt:"-2",children:["WebRTC Relays are temporary relays that can be accessed over"," ",e.jsx(W,{href:"https://webrtc.org/",target:"_blank",color:"blue.500",children:"WebRTC"})]}),e.jsx(x,{size:"md",mt:"2",children:"Connections:"}),r.answered.length>0?r.answered.map(({call:a,peer:u,pubkey:t})=>e.jsx(P,{peer:u,call:a,client:r.clients.get(t),server:r.servers.get(t)},t)):e.jsxs(q,{status:"info",children:[e.jsx(G,{}),'No connections yet, use the "Invite" or "Connect" buttons to connect to peer']})]})}export{V as default};
//# sourceMappingURL=index-DAdmyE3k.js.map
