{"version":3,"file":"video-BdDGn0qX.js","sources":["../../src/views/videos/components/video-menu.tsx","../../src/components/event-reactions/simple-dislike-button.tsx","../../src/components/simple-bookmark-button.tsx","../../src/views/videos/video.tsx"],"sourcesContent":["import { DotsMenuButton, MenuIconButtonProps } from \"../../../components/dots-menu-button\";\nimport OpenInAppMenuItem from \"../../../components/common-menu-items/open-in-app\";\nimport ShareLinkMenuItem from \"../../../components/common-menu-items/share-link\";\nimport CopyEmbedCodeMenuItem from \"../../../components/common-menu-items/copy-embed-code\";\nimport MuteUserMenuItem from \"../../../components/common-menu-items/mute-user\";\nimport { NostrEvent } from \"../../../types/nostr-event\";\nimport DebugEventMenuItem from \"../../../components/debug-modal/debug-event-menu-item\";\n\nexport default function VideoMenu({ video, ...props }: { video: NostrEvent } & Omit<MenuIconButtonProps, \"children\">) {\n  return (\n    <>\n      <DotsMenuButton {...props}>\n        <OpenInAppMenuItem event={video} />\n        <ShareLinkMenuItem event={video} />\n        <CopyEmbedCodeMenuItem event={video} />\n        <MuteUserMenuItem event={video} />\n        <DebugEventMenuItem event={video} />\n      </DotsMenuButton>\n    </>\n  );\n}\n","import { useMemo } from \"react\";\n\nimport { NostrEvent } from \"../../types/nostr-event\";\nimport useEventReactions from \"../../hooks/use-event-reactions\";\nimport { groupReactions } from \"../../helpers/nostr/reactions\";\nimport useCurrentAccount from \"../../hooks/use-current-account\";\nimport ReactionGroupButton from \"./reaction-group-button\";\nimport { useAddReaction } from \"./common-hooks\";\nimport { ButtonProps } from \"@chakra-ui/react\";\n\nexport default function SimpleDislikeButton({\n  event,\n  ...props\n}: Omit<ButtonProps, \"children\"> & { event: NostrEvent }) {\n  const account = useCurrentAccount();\n  const reactions = useEventReactions(event) ?? [];\n  const grouped = useMemo(() => groupReactions(reactions), [reactions]);\n\n  const addReaction = useAddReaction(event, grouped);\n  const group = grouped.find((g) => g.emoji === \"-\");\n\n  return (\n    <ReactionGroupButton\n      emoji=\"-\"\n      count={group?.pubkeys.length ?? 0}\n      onClick={() => addReaction(\"-\")}\n      colorScheme={account && group?.pubkeys.includes(account?.pubkey) ? \"primary\" : undefined}\n      {...props}\n    />\n  );\n}\n","import { IconButton, IconButtonProps } from \"@chakra-ui/react\";\n\nimport { NostrEvent } from \"../types/nostr-event\";\nimport useCurrentAccount from \"../hooks/use-current-account\";\nimport useEventBookmarkActions from \"../hooks/use-event-bookmark-actions\";\nimport { BookmarkIcon, BookmarkedIcon } from \"./icons\";\n\nexport default function SimpleBookmarkButton({\n  event,\n  ...props\n}: { event: NostrEvent } & Omit<IconButtonProps, \"icon\">) {\n  const account = useCurrentAccount();\n\n  const { isLoading, toggleBookmark, isBookmarked } = useEventBookmarkActions(event);\n\n  return (\n    <IconButton\n      icon={isBookmarked ? <BookmarkedIcon /> : <BookmarkIcon />}\n      isDisabled={account?.readonly ?? true}\n      onClick={toggleBookmark}\n      isLoading={isLoading}\n      {...props}\n    />\n  );\n}\n","import { Box, ButtonGroup, Flex, Heading, Spinner, Tag, Text } from \"@chakra-ui/react\";\nimport { getEventUID } from \"applesauce-core/helpers\";\n\nimport VerticalPageLayout from \"../../components/vertical-page-layout\";\nimport {\n  FLARE_VIDEO_KIND,\n  getVideoImages,\n  getVideoSummary,\n  getVideoTitle,\n  getVideoUrl,\n} from \"../../helpers/nostr/flare\";\nimport { NostrEvent } from \"../../types/nostr-event\";\nimport useParamsAddressPointer from \"../../hooks/use-params-address-pointer\";\nimport useReplaceableEvent from \"../../hooks/use-replaceable-event\";\nimport UserAvatarLink from \"../../components/user/user-avatar-link\";\nimport UserLink from \"../../components/user/user-link\";\nimport UserDnsIdentity from \"../../components/user/user-dns-identity\";\nimport { UserFollowButton } from \"../../components/user/user-follow-button\";\nimport VideoMenu from \"./components/video-menu\";\nimport SimpleLikeButton from \"../../components/event-reactions/simple-like-button\";\nimport SimpleDislikeButton from \"../../components/event-reactions/simple-dislike-button\";\nimport { ErrorBoundary } from \"../../components/error-boundary\";\nimport { useReadRelays } from \"../../hooks/use-client-relays\";\nimport useTimelineLoader from \"../../hooks/use-timeline-loader\";\nimport VideoCard from \"./components/video-card\";\nimport UserName from \"../../components/user/user-name\";\nimport { useBreakpointValue } from \"../../providers/global/breakpoint-provider\";\nimport SimpleBookmarkButton from \"../../components/simple-bookmark-button\";\nimport NoteZapButton from \"../../components/note/note-zap-button\";\nimport QuoteEventButton from \"../../components/note/quote-event-button\";\n\nfunction VideoRecommendations({ video }: { video: NostrEvent }) {\n  const readRelays = useReadRelays();\n  const { loader, timeline: videos } = useTimelineLoader(video.pubkey + \"-videos\", readRelays, {\n    authors: [video.pubkey],\n    kinds: [FLARE_VIDEO_KIND],\n  });\n  return <>{videos?.slice(0, 8).map((v) => <VideoCard key={getEventUID(v)} video={v} />)}</>;\n}\n\nfunction VideoDetailsPage({ video }: { video: NostrEvent }) {\n  const title = getVideoTitle(video);\n  const { thumb, image } = getVideoImages(video);\n  const summary = getVideoSummary(video);\n  const url = getVideoUrl(video);\n\n  const showSideBar = useBreakpointValue({ base: false, xl: true });\n\n  return (\n    <VerticalPageLayout>\n      <Flex gap=\"4\">\n        <Flex direction=\"column\" gap=\"2\" flexGrow={1}>\n          <Box as=\"video\" src={url} w=\"full\" maxH=\"95vh\" controls poster={image || thumb} />\n          <Flex gap=\"2\" overflow=\"hidden\">\n            <Heading size=\"md\" my=\"2\" isTruncated>\n              {title}\n            </Heading>\n            <ButtonGroup ml=\"auto\" size=\"sm\" variant=\"ghost\">\n              <NoteZapButton event={video} />\n              <SimpleLikeButton event={video} />\n              <SimpleDislikeButton event={video} />\n            </ButtonGroup>\n          </Flex>\n          <Flex gap=\"2\" alignItems=\"center\">\n            <UserAvatarLink pubkey={video.pubkey} size=\"sm\" />\n            <UserLink pubkey={video.pubkey} fontSize=\"lg\" tab=\"videos\" />\n            <UserDnsIdentity pubkey={video.pubkey} onlyIcon />\n            <UserFollowButton pubkey={video.pubkey} size=\"sm\" />\n            <ButtonGroup ml=\"auto\" size=\"sm\" variant=\"ghost\">\n              <SimpleBookmarkButton event={video} aria-label=\"Bookmark video\" title=\"Bookmark video\" />\n              <QuoteEventButton event={video} />\n            </ButtonGroup>\n            <VideoMenu video={video} aria-label=\"More options\" size=\"sm\" />\n          </Flex>\n          <Text mt=\"2\" whiteSpace=\"pre-line\">\n            {summary}\n          </Text>\n          <Flex gap=\"2\" wrap=\"wrap\">\n            {video.tags\n              .filter((t) => t[0] === \"t\")\n              .map((tag) => (\n                <Tag key={tag[1]}>{tag[1]}</Tag>\n              ))}\n          </Flex>\n        </Flex>\n        {showSideBar && (\n          <Flex gap=\"2\" direction=\"column\" w=\"sm\" flexShrink={0}>\n            <Heading size=\"sm\">\n              Other videos by <UserName pubkey={video.pubkey} />:\n            </Heading>\n            <VideoRecommendations video={video} />\n          </Flex>\n        )}\n      </Flex>\n    </VerticalPageLayout>\n  );\n}\n\nexport default function VideoDetailsView() {\n  const pointer = useParamsAddressPointer(\"naddr\");\n  const video = useReplaceableEvent(pointer);\n\n  if (!video) return <Spinner />;\n\n  return (\n    <ErrorBoundary>\n      <VideoDetailsPage video={video} />\n    </ErrorBoundary>\n  );\n}\n"],"names":["VideoMenu","video","props","jsx","Fragment","jsxs","DotsMenuButton","OpenInAppMenuItem","ShareLinkMenuItem","CopyEmbedCodeMenuItem","MuteUserMenuItem","DebugEventMenuItem","SimpleDislikeButton","event","account","useCurrentAccount","reactions","useEventReactions","grouped","useMemo","groupReactions","addReaction","useAddReaction","group","g","ReactionGroupButton","SimpleBookmarkButton","isLoading","toggleBookmark","isBookmarked","useEventBookmarkActions","IconButton","BookmarkedIcon","BookmarkIcon","VideoRecommendations","readRelays","useReadRelays","loader","videos","useTimelineLoader","FLARE_VIDEO_KIND","v","VideoCard","getEventUID","VideoDetailsPage","title","getVideoTitle","thumb","image","getVideoImages","summary","getVideoSummary","url","getVideoUrl","showSideBar","useBreakpointValue","VerticalPageLayout","Flex","Box","Heading","ButtonGroup","NoteZapButton","SimpleLikeButton","UserAvatarLink","UserLink","UserDnsIdentity","UserFollowButton","QuoteEventButton","Text","t","tag","Tag","UserName","VideoDetailsView","pointer","useParamsAddressPointer","useReplaceableEvent","ErrorBoundary","Spinner"],"mappings":"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"}