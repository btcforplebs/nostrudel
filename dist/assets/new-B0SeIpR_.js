import{r as g,bi as ke,hl as ue,b9 as je,ba as we,j as i,bc as ve,bb as Re,hm as Se,hn as Ie,ho as k,bk as D,bj as O,hp as De,hq as Ae,hr as W,hs as Pe,ht as Ee,e3 as de,a6 as Fe,ae as Te,b4 as Ne,bI as _e,b$ as Be,t as Me,aw as qe,cn as $,co as Y,dB as Ve,V as Le,H as X,y as Ue,hu as Ge,E as q,F as N,v as Z,B as J,fX as He,fY as ze,fZ as Ke,f_ as Oe,f$ as We,h6 as $e}from"./index-C6wlVu-O.js";function Ye(e){return e&&ue(e)&&ue(e.target)}function fe(e={}){const{onChange:t,value:s,defaultValue:n,name:o,isDisabled:r,isFocusable:a,isNative:m,...d}=e,[j,C]=g.useState(n||""),v=typeof s<"u",I=v?s:j,R=g.useRef(null),P=g.useCallback(()=>{const l=R.current;if(!l)return;let p="input:not(:disabled):checked";const S=l.querySelector(p);if(S){S.focus();return}p="input:not(:disabled)";const w=l.querySelector(p);w==null||w.focus()},[]),x=`radio-${g.useId()}`,u=o||x,y=g.useCallback(l=>{const p=Ye(l)?l.target.value:l;v||C(p),t==null||t(String(p))},[t,v]),b=g.useCallback((l={},p=null)=>({...l,ref:ke(p,R),role:"radiogroup"}),[]),h=g.useCallback((l={},p=null)=>({...l,ref:p,name:u,[m?"checked":"isChecked"]:I!=null?l.value===I:void 0,onChange(w){y(w)},"data-radiogroup":!0}),[m,u,y,I]);return{getRootProps:b,getRadioProps:h,name:u,ref:R,focus:P,setValue:C,value:I,onChange:y,isDisabled:r,isFocusable:a,htmlProps:d}}var[Xe,Ze]=je({name:"RadioGroupContext",strict:!1}),Je=we((e,t)=>{const{colorScheme:s,size:n,variant:o,children:r,className:a,isDisabled:m,isFocusable:d,...j}=e,{value:C,onChange:v,getRootProps:I,name:R,htmlProps:P}=fe(j),E=g.useMemo(()=>({name:R,size:n,onChange:v,colorScheme:s,value:C,variant:o,isDisabled:m,isFocusable:d}),[R,n,v,s,C,o,m,d]);return i.jsx(Xe,{value:E,children:i.jsx(ve.div,{...I(P,t),className:Re("chakra-radio-group",a),children:r})})});Je.displayName="RadioGroup";var Qe={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function et(e={}){const{defaultChecked:t,isChecked:s,isFocusable:n,isDisabled:o,isReadOnly:r,isRequired:a,onChange:m,isInvalid:d,name:j,value:C,id:v,"data-radiogroup":I,"aria-describedby":R,...P}=e,E=`radio-${g.useId()}`,x=Se(),y=!!Ze()||!!I;let h=!!x&&!y?x.id:E;h=v??h;const l=o??(x==null?void 0:x.isDisabled),p=r??(x==null?void 0:x.isReadOnly),S=a??(x==null?void 0:x.isRequired),w=d??(x==null?void 0:x.isInvalid),[B,G]=g.useState(!1),[L,te]=g.useState(!1),[H,ne]=g.useState(!1),[z,_]=g.useState(!1),[ye,xe]=g.useState(!!t),K=typeof s<"u",F=K?s:ye;g.useEffect(()=>Ie(G),[]);const se=g.useCallback(f=>{if(p||l){f.preventDefault();return}K||xe(f.target.checked),m==null||m(f)},[K,l,p,m]),oe=g.useCallback(f=>{f.key===" "&&_(!0)},[_]),ie=g.useCallback(f=>{f.key===" "&&_(!1)},[_]),re=g.useCallback((f={},T=null)=>({...f,ref:T,"data-active":k(z),"data-hover":k(H),"data-disabled":k(l),"data-invalid":k(w),"data-checked":k(F),"data-focus":k(L),"data-focus-visible":k(L&&B),"data-readonly":k(p),"aria-hidden":!0,onMouseDown:D(f.onMouseDown,()=>_(!0)),onMouseUp:D(f.onMouseUp,()=>_(!1)),onMouseEnter:D(f.onMouseEnter,()=>ne(!0)),onMouseLeave:D(f.onMouseLeave,()=>ne(!1))}),[z,H,l,w,F,L,p,B]),{onFocus:ae,onBlur:le}=x??{},Ce=g.useCallback((f={},T=null)=>{const ce=l&&!n;return{...f,id:h,ref:T,type:"radio",name:j,value:C,onChange:D(f.onChange,se),onBlur:D(le,f.onBlur,()=>te(!1)),onFocus:D(ae,f.onFocus,()=>te(!0)),onKeyDown:D(f.onKeyDown,oe),onKeyUp:D(f.onKeyUp,ie),checked:F,disabled:ce,readOnly:p,required:S,"aria-invalid":O(w),"aria-disabled":O(ce),"aria-required":O(S),"data-readonly":k(p),"aria-describedby":R,style:Qe}},[l,n,h,j,C,se,le,ae,oe,ie,F,p,S,w,R]);return{state:{isInvalid:w,isFocused:L,isChecked:F,isActive:z,isHovered:H,isDisabled:l,isReadOnly:p,isRequired:S},getCheckboxProps:re,getRadioProps:re,getInputProps:Ce,getLabelProps:(f={},T=null)=>({...f,ref:T,onMouseDown:D(f.onMouseDown,tt),"data-disabled":k(l),"data-checked":k(F),"data-invalid":k(w)}),getRootProps:(f,T=null)=>({...f,ref:T,"data-disabled":k(l),"data-checked":k(F),"data-invalid":k(w)}),htmlProps:P}}function tt(e){e.preventDefault(),e.stopPropagation()}const M=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),A=new Uint32Array(80);class nt extends Ae{constructor(){super(64,20,8,!1),this.A=M[0]|0,this.B=M[1]|0,this.C=M[2]|0,this.D=M[3]|0,this.E=M[4]|0}get(){const{A:t,B:s,C:n,D:o,E:r}=this;return[t,s,n,o,r]}set(t,s,n,o,r){this.A=t|0,this.B=s|0,this.C=n|0,this.D=o|0,this.E=r|0}process(t,s){for(let d=0;d<16;d++,s+=4)A[d]=t.getUint32(s,!1);for(let d=16;d<80;d++)A[d]=W(A[d-3]^A[d-8]^A[d-14]^A[d-16],1);let{A:n,B:o,C:r,D:a,E:m}=this;for(let d=0;d<80;d++){let j,C;d<20?(j=Pe(o,r,a),C=1518500249):d<40?(j=o^r^a,C=1859775393):d<60?(j=Ee(o,r,a),C=2400959708):(j=o^r^a,C=3395469782);const v=W(n,5)+j+m+C+A[d]|0;m=a,a=r,r=W(o,30),o=n,n=v}n=n+this.A|0,o=o+this.B|0,r=r+this.C|0,a=a+this.D|0,m=m+this.E|0,this.set(n,o,r,a,m)}roundClean(){A.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const st=De(()=>new nt);function ot(e){return ArrayBuffer.isView(e)?"arraybufferview":Array.isArray(e)?"array":e instanceof Number?"number":e instanceof Boolean?"boolean":e instanceof Set?"set":e instanceof Map?"map":e instanceof String?"string":e instanceof ArrayBuffer?"arraybuffer":typeof e}function V(e){return new TextEncoder().encode(e)}function it(e){const t=e.reduce((o,r)=>o+r.length,0),s=new Uint8Array(t);let n=0;for(const o of e)s.set(o,n),n+=o.length;return s}function c(e,t,s){const n=[];let o=null;return c._encode(n,e),o=it(n),c.bytes=o.length,ArrayBuffer.isView(t)?(t.set(o,s),t):o}c.bytes=-1;c._floatConversionDetected=!1;c._encode=function(e,t){if(t!=null)switch(ot(t)){case"object":c.dict(e,t);break;case"map":c.dictMap(e,t);break;case"array":c.list(e,t);break;case"set":c.listSet(e,t);break;case"string":c.string(e,t);break;case"number":c.number(e,t);break;case"boolean":c.number(e,t);break;case"arraybufferview":c.buffer(e,new Uint8Array(t.buffer,t.byteOffset,t.byteLength));break;case"arraybuffer":c.buffer(e,new Uint8Array(t));break}};const U=new Uint8Array([101]),he=new Uint8Array([100]),pe=new Uint8Array([108]);c.buffer=function(e,t){e.push(V(t.length+":"),t)};c.string=function(e,t){e.push(V(V(t).byteLength+":"+t))};c.number=function(e,t){if(Number.isInteger(t))return e.push(V("i"+BigInt(t)+"e"));const s=2147483648,n=t/s<<0,o=t%s<<0,r=n*s+o;e.push(V("i"+r+"e")),r!==t&&!c._floatConversionDetected&&(c._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+t+'":','Bencoding only defines support for integers, value was converted to "'+r+'"'),console.trace())};c.dict=function(e,t){e.push(he);let s=0,n;const o=Object.keys(t).sort(),r=o.length;for(;s<r;s++)n=o[s],t[n]!=null&&(c.string(e,n),c._encode(e,t[n]));e.push(U)};c.dictMap=function(e,t){e.push(he);const s=Array.from(t.keys()).sort();for(const n of s)t.get(n)!=null&&(ArrayBuffer.isView(n)?c._encode(e,n):c.string(e,String(n)),c._encode(e,t.get(n)));e.push(U)};c.list=function(e,t){let s=0;const n=t.length;for(e.push(pe);s<n;s++)t[s]!=null&&c._encode(e,t[s]);e.push(U)};c.listSet=function(e,t){e.push(pe);for(const s of t)s!=null&&c._encode(e,s);e.push(U)};const rt=105,at=58,lt=100,ct=108,Q=101;function ge(e,t,s){let n=0,o=1;for(let r=t;r<s;r++){const a=e[r];if(a<58&&a>=48){n=n*10+(a-48);continue}if(!(r===t&&a===43)){if(r===t&&a===45){o=-1;continue}if(a===46)break;throw new Error("not a number: buffer["+r+"] = "+a)}}return n*o}function ut(e,t,s,n){const o={position:0,bytes:0,encoding:n,data:e.subarray(t,s)};return o.bytes=o.data.length,ee(o)}function be(e){let t=me(e,at);const s=ge(e.data,e.position,t),n=++t+s;return e.position=n,e.data.subarray(t,n)}function ee(e){switch(e.data[e.position]){case lt:return dt(e);case ct:return ft(e);case rt:return ht(e);default:return be(e)}}function me(e,t){let s=e.position;const n=e.data.length,o=e.data;for(;s<n;){if(o[s]===t)return s;s++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(t)+'" [0x'+t.toString(16)+"]")}function dt(e){e.position++;const t={};for(;e.data[e.position]!==Q;){const s=be(e);let n=new TextDecoder().decode(s);n.includes("ï¿½")&&(n=de(s)),t[n]=ee(e)}return e.position++,t}function ft(e){e.position++;const t=[];for(;e.data[e.position]!==Q;)t.push(ee(e));return e.position++,t}function ht(e){const t=me(e,Q),s=ge(e.data,e.position+1,t);return e.position+=t+1-e.position,s}function pt(e){const{getInputProps:t,getRadioProps:s}=et(e),n=t(),o=s();return i.jsxs(J,{as:"label",children:[i.jsx("input",{...n}),i.jsx(q,{as:"div",...o,cursor:"pointer",variant:"outline",colorScheme:o["data-checked"]!==void 0?"primary":void 0,px:"3",py:"1",size:"sm",children:e.children})]})}function xt(){const e=Fe(),t=Te(),s=g.useRef(null),n=Ne({base:!0,lg:!1}),{getValues:o,watch:r,setValue:a,register:m,handleSubmit:d,formState:j}=_e({defaultValues:{title:"",description:"",btih:"",tags:[],files:[]}}),C=async u=>{const y=await u.arrayBuffer(),b=ut(new Uint8Array(y)),h=c(b.info),l=b.info,p=new TextDecoder;a("title",p.decode(l.name));const S=p.decode(b.comment)??"";S&&a("description",S),a("btih",de(st(h))),a("tags",[]);const w=(l.files??[{length:l.length,path:[l.name]}]).map(B=>({size:B.length,name:B.path.map(G=>p.decode(G)).join("/")}));a("files",w)},v=d(async u=>{const y={kind:Be,content:u.description,tags:[["title",u.title],["x",u.btih],...u.tags.map(h=>["t",h]),...u.files.map(h=>["file",h.name,String(h.size)])],created_at:Me().unix()},b=await e("Publish Torrent",y);b&&t(`/torrents/${qe.noteEncode(b.event.id)}`)}),{getRootProps:I,getRadioProps:R}=fe({name:"category",value:o().tags.join(","),onChange:u=>a("tags",u.split(","),{shouldDirty:!0,shouldTouch:!0})});r("tags"),r("files");function P(){return i.jsx(i.Fragment,{children:$e.map(u=>i.jsxs(J,{children:[i.jsx(X,{size:"sm",mt:"2",mb:"1",children:u.name}),i.jsx(N,{gap:"2",wrap:"wrap",children:E(u,[u.tag])})]},u.tag))})}function E(u,y){var b;return i.jsxs(i.Fragment,{children:[i.jsx(pt,{...R({value:y.join(",")}),children:u.name}),(b=u.sub_category)==null?void 0:b.map(h=>E(h,[...y,h.tag]))]})}const x=i.jsxs($,{isRequired:!0,children:[i.jsx(Y,{children:"Description"}),i.jsx(Ve,{placeholder:"Description",rows:n?10:25,...m("description",{required:!0})})]});return i.jsxs(Le,{as:"form",onSubmit:v,children:[i.jsx(X,{size:"lg",children:"New Torrent"}),i.jsxs(Ue,{children:[i.jsx(Ge,{type:"file",accept:"application/x-bittorrent",ref:s,onChange:u=>{var b;const y=(b=u.target.files)==null?void 0:b[0];y&&C(y)}}),i.jsx(q,{onClick:()=>{var u;return(u=s.current)==null?void 0:u.click()},children:"Import Torrent file"})]}),i.jsxs(N,{gap:"4",children:[i.jsxs(N,{gap:"2",direction:"column",w:"full",children:[i.jsxs($,{isRequired:!0,children:[i.jsx(Y,{children:"Title"}),i.jsx(Z,{type:"text",...m("title",{required:!0})})]}),i.jsxs($,{isRequired:!0,children:[i.jsx(Y,{children:"Info Hash"}),i.jsx(Z,{type:"text",...m("btih",{required:!0}),placeholder:"hex"})]}),n&&x,i.jsx(X,{size:"md",children:"Category"}),i.jsx(J,{...I(),children:P()})]}),!n&&i.jsx(N,{gap:"2",direction:"column",w:"full",children:x})]}),i.jsx(N,{direction:"column",gap:"2",children:o().files.map((u,y)=>i.jsxs(N,{gap:"2",children:[i.jsx(Z,{type:"text",value:u.name,className:"flex-1",placeholder:"collection1/IMG_00001.jpg",onChange:b=>a("files",o().files.map((h,l)=>l===y?{...h,name:b.target.value}:h))}),i.jsxs(He,{value:u.size,min:0,onChange:b=>a("files",o().files.map((h,l)=>l===y?{...h,size:parseInt(b)}:h)),children:[i.jsx(ze,{}),i.jsxs(Ke,{children:[i.jsx(Oe,{}),i.jsx(We,{})]})]}),i.jsx(q,{flexShrink:0,onClick:()=>a("files",o().files.filter((b,h)=>y!==h)),children:"Remove"})]}))}),i.jsxs(N,{gap:"2",justifyContent:"flex-end",children:[i.jsx(q,{onClick:()=>a("files",[...o().files,{name:"",size:0}]),children:"Add file info"}),i.jsx(q,{type:"submit",isLoading:j.isSubmitting,colorScheme:"primary",children:"Publish"})]})]})}export{xt as default};
//# sourceMappingURL=new-B0SeIpR_.js.map
