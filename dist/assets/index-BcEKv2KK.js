import{t as f,dx as p,bH as y,r as i,j as e,z as j,cU as D,ds as R,fD as A,p as N,V as B,F as w,cf as z,H as O,y as k,E as g,l as m,v as F,fE as $,c0 as P,c1 as V,c2 as _,c3 as T,c4 as d,c5 as q,eu as h,w as H,aX as J,eP as M,fF as G}from"./index-C6wlVu-O.js";import{f as K}from"./number-BsCqcFD4.js";const C="https://api.satellite.earth/v1/media";function Q(t){return t({created_at:f().unix(),kind:22242,content:"Authenticate User",tags:[]})}async function X(t){return fetch(`${C}/account?auth=${encodeURIComponent(JSON.stringify(t))}`).then(s=>s.json())}async function W(t,s){const a={created_at:f().unix(),kind:22242,content:"Delete Item",tags:[["x",t]]},o=await s(a);await fetch(`${C}/item?auth=${encodeURIComponent(JSON.stringify(o))}`,{method:"DELETE"})}async function Y(t,s){const a={created_at:f().unix(),kind:22242,content:"Authorize Upload",tags:[["name",t.name]]},o=await s(a);return await fetch(`${C}/item?auth=${encodeURIComponent(JSON.stringify(o))}`,{method:"PUT",body:t}).then(n=>n.json())}function Z({file:t}){const s=p(),{requestSignature:a}=y(),[o,n]=i.useState(!1),l=i.useCallback(async()=>{n(!0);try{await W(t.sha256,a)}catch(r){r instanceof Error&&s({description:r.message,status:"error"})}n(!1)},[a,t]);return e.jsx(j,{icon:e.jsx(D,{}),"aria-label":"Delete File",title:"Delete File",colorScheme:"red",onClick:l,isLoading:o})}function ee({file:t,"aria-label":s,title:a="Share File",...o}){const{openModal:n}=i.useContext(R),l=()=>{n({cacheFormKey:null,initContent:`
`+t.url})};return e.jsx(j,{icon:e.jsx(A,{}),onClick:l,"aria-label":s||a,title:a,...o})}function te(){const t=p(),{requestSignature:s}=y(),a=i.useRef(null),[o,n]=i.useState(!1),l=i.useCallback(async r=>{n(!0);try{const c=await Y(r,s)}catch(c){c instanceof Error&&t({description:c.message,status:"error"})}n(!1)},[s]);return e.jsxs(e.Fragment,{children:[e.jsx(F,{type:"file",hidden:!0,ref:a,onChange:r=>{var c;(c=r.target.files)!=null&&c[0]&&l(r.target.files[0])}}),e.jsx(g,{colorScheme:"primary",onClick:()=>{var r;return(r=a.current)==null?void 0:r.click()},isLoading:o,children:"Upload File"})]})}function se({file:t}){return e.jsx(e.Fragment,{children:e.jsxs(T,{children:[e.jsxs(h,{children:[e.jsx(m,{isExternal:!0,href:t.url,children:t.name}),e.jsx(H,{value:t.url,"aria-label":"Copy URL",title:"Copy URL",size:"xs",variant:"ghost",ml:"2"})]}),e.jsx(h,{isNumeric:!0,children:K(t.size)}),e.jsx(h,{children:t.type}),e.jsx(h,{children:e.jsx(J,{timestamp:t.created})}),e.jsx(h,{isNumeric:!0,children:e.jsxs(k,{size:"sm",variant:"ghost",children:[e.jsx(ee,{file:t}),e.jsx(j,{as:m,href:t.url,icon:e.jsx(M,{}),"aria-label":"Download",download:t.name,isExternal:!0}),e.jsx(j,{as:m,href:t.magnet,icon:e.jsx(G,{}),"aria-label":"Open Magnet",isExternal:!0}),e.jsx(Z,{file:t})]})})]})})}function b({files:t}){return e.jsx(P,{children:e.jsxs(V,{size:"sm",children:[e.jsx(_,{children:e.jsxs(T,{children:[e.jsx(d,{children:"Name"}),e.jsx(d,{isNumeric:!0,children:"Size"}),e.jsx(d,{children:"Type"}),e.jsx(d,{children:"Created"}),e.jsx(d,{isNumeric:!0})]})}),e.jsx(q,{children:t.map(s=>e.jsx(se,{file:s},s.sha256))})]})})}function re(){const t=p(),{requestSignature:s}=y(),[a,o]=i.useState(),{value:n,loading:l}=N(async()=>a&&await X(a),[a]),[r,c]=i.useState(!1),L=i.useCallback(async()=>{c(!0);try{o(await Q(s))}catch(u){u instanceof Error&&t({description:u.message,status:"error"})}c(!1)},[s]),[x,E]=i.useState(""),I=()=>{if(!n)return e.jsx(g,{onClick:L,mx:"auto",px:"10",my:"8",colorScheme:"primary",isLoading:r||l,autoFocus:!0,children:"Unlock Account"});if(x){const u=n.files.filter(v=>{var S;return(S=v.name)==null?void 0:S.toLowerCase().includes(x.toLowerCase().trim())}),U=$(u,x.toLowerCase().trim(),{keys:["name"]});return e.jsx(b,{files:U})}else return e.jsx(b,{files:n.files})};return e.jsxs(B,{children:[e.jsxs(w,{gap:"2",alignItems:"center",wrap:"wrap",children:[e.jsx(z,{src:"https://satellite.earth/image.png",w:"12"}),e.jsx(O,{children:"Satellite CDN"}),e.jsxs(k,{ml:"auto",children:[e.jsx(g,{as:m,href:"https://github.com/lovvtide/satellite-web/blob/master/docs/cdn.md",isExternal:!0,variant:"ghost",children:"View Docs"}),e.jsx(te,{})]})]}),n&&e.jsx(w,{gap:"2",children:e.jsx(F,{type:"Search",placeholder:"Search files",w:{base:"full",md:"md"},value:x,onChange:u=>E(u.target.value)})}),I()]})}export{re as default};
//# sourceMappingURL=index-BcEKv2KK.js.map
