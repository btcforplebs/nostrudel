{"version":3,"file":"feed-CD4XFirR.js","sources":["../../node_modules/.pnpm/@chakra-ui+icons@2.1.1_@chakra-ui+system@2.6.2_@emotion+react@11.13.3_@types+react@18.3.10_re_dume5a75vd6xihffqcgpvpf3zi/node_modules/@chakra-ui/icons/dist/chunk-VCNDIGGI.mjs","../../node_modules/.pnpm/webln@0.3.2/node_modules/webln/lib/errors.js","../../node_modules/.pnpm/webln@0.3.2/node_modules/webln/lib/client.js","../../node_modules/.pnpm/webln@0.3.2/node_modules/webln/lib/provider.js","../../node_modules/.pnpm/webln@0.3.2/node_modules/webln/lib/index.js","../../src/components/lightning/inline-invoice-card.tsx","../../src/views/discovery/dvm-feed/components/debug-chains.tsx","../../src/views/discovery/dvm-feed/components/feed-status.tsx","../../src/views/discovery/dvm-feed/components/feed.tsx","../../src/views/discovery/dvm-feed/components/dvm-params.tsx","../../src/views/discovery/dvm-feed/feed.tsx"],"sourcesContent":["'use client'\n\n// src/ChevronLeft.tsx\nimport { createIcon } from \"@chakra-ui/icon\";\nvar ChevronLeftIcon = createIcon({\n  d: \"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\",\n  displayName: \"ChevronLeftIcon\"\n});\n\nexport {\n  ChevronLeftIcon\n};\n//# sourceMappingURL=chunk-VCNDIGGI.mjs.map","\"use strict\";\n/* tslint:disable:max-classes-per-file */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InternalError = exports.InvalidDataError = exports.RoutingError = exports.UnsupportedMethodError = exports.ConnectionError = exports.RejectionError = exports.MissingProviderError = void 0;\n/**\n * Workaround for custom errors when compiling typescript targeting 'ES5'.\n * see: https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n * @param {CustomError} error\n * @param newTarget the value of `new.target`\n * @param {Function} errorType\n */\nfunction fixError(error, newTarget, errorType) {\n    Object.setPrototypeOf(error, errorType.prototype);\n    // when an error constructor is invoked with the `new` operator\n    if (newTarget === errorType) {\n        error.name = newTarget.name;\n        // exclude the constructor call of the error type from the stack trace.\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(error, errorType);\n        }\n        else {\n            var stack = new Error(error.message).stack;\n            if (stack) {\n                error.stack = fixStack(stack, \"new \".concat(newTarget.name));\n            }\n        }\n    }\n}\nfunction fixStack(stack, functionName) {\n    if (!stack)\n        return stack;\n    if (!functionName)\n        return stack;\n    // exclude lines starts with:  \"  at functionName \"\n    var exclusion = new RegExp(\"\\\\s+at\\\\s\".concat(functionName, \"\\\\s\"));\n    var lines = stack.split(\"\\n\");\n    var resultLines = lines.filter(function (line) { return !line.match(exclusion); });\n    return resultLines.join(\"\\n\");\n}\n/// CUSTOM ERRORS ///\n// When no WebLN provider is available\nvar MissingProviderError = /** @class */ (function (_super) {\n    __extends(MissingProviderError, _super);\n    function MissingProviderError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, MissingProviderError);\n        return _this;\n    }\n    return MissingProviderError;\n}(Error));\nexports.MissingProviderError = MissingProviderError;\n// When the user rejects a request\nvar RejectionError = /** @class */ (function (_super) {\n    __extends(RejectionError, _super);\n    function RejectionError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, RejectionError);\n        return _this;\n    }\n    return RejectionError;\n}(Error));\nexports.RejectionError = RejectionError;\n// When the node can't be connected to (i.e. the app did nothing wrong)\nvar ConnectionError = /** @class */ (function (_super) {\n    __extends(ConnectionError, _super);\n    function ConnectionError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, ConnectionError);\n        return _this;\n    }\n    return ConnectionError;\n}(Error));\nexports.ConnectionError = ConnectionError;\n// The WebLN provider doesn't support this method\nvar UnsupportedMethodError = /** @class */ (function (_super) {\n    __extends(UnsupportedMethodError, _super);\n    function UnsupportedMethodError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, UnsupportedMethodError);\n        return _this;\n    }\n    return UnsupportedMethodError;\n}(Error));\nexports.UnsupportedMethodError = UnsupportedMethodError;\n// The desired node couldn't be routed to\nvar RoutingError = /** @class */ (function (_super) {\n    __extends(RoutingError, _super);\n    function RoutingError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, RoutingError);\n        return _this;\n    }\n    return RoutingError;\n}(Error));\nexports.RoutingError = RoutingError;\n// An argument passed was somehow invalid (e.g. malformed invoice)\nvar InvalidDataError = /** @class */ (function (_super) {\n    __extends(InvalidDataError, _super);\n    function InvalidDataError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, InvalidDataError);\n        return _this;\n    }\n    return InvalidDataError;\n}(Error));\nexports.InvalidDataError = InvalidDataError;\n// Something broke in the WebLN provider internally, nothing to do with the app\nvar InternalError = /** @class */ (function (_super) {\n    __extends(InternalError, _super);\n    function InternalError(message) {\n        var _newTarget = this.constructor;\n        var _this = _super.call(this, message) || this;\n        fixError(_this, _newTarget, InternalError);\n        return _this;\n    }\n    return InternalError;\n}(Error));\nexports.InternalError = InternalError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.requestProvider = void 0;\nvar errors_1 = require(\"./errors\");\nfunction requestProvider(_) {\n    if (_ === void 0) { _ = {}; }\n    return new Promise(function (resolve, reject) {\n        if (typeof window === 'undefined') {\n            return reject(new Error('Must be called in a browser context'));\n        }\n        var webln = window.webln;\n        if (!webln) {\n            return reject(new errors_1.MissingProviderError('Your browser has no WebLN provider'));\n        }\n        webln.enable()\n            .then(function () { return resolve(webln); })\n            .catch(function (err) { return reject(err); });\n    });\n}\nexports.requestProvider = requestProvider;\n","\"use strict\";\n/**\n * Everything needed to implement your own provider.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./client\"), exports);\n__exportStar(require(\"./provider\"), exports);\n__exportStar(require(\"./errors\"), exports);\n","import React, { useState } from \"react\";\nimport { useAsync } from \"react-use\";\nimport dayjs from \"dayjs\";\nimport { requestProvider } from \"webln\";\nimport {\n  Box,\n  BoxProps,\n  Button,\n  ButtonGroup,\n  CloseButton,\n  Flex,\n  IconButton,\n  Input,\n  Text,\n  useDisclosure,\n} from \"@chakra-ui/react\";\n\nimport { parsePaymentRequest, readablizeSats } from \"../../helpers/bolt11\";\nimport { CopyIconButton } from \"../copy-icon-button\";\nimport QrCode02 from \"../icons/qr-code-02\";\nimport QrCodeSvg from \"../qr-code/qr-code-svg\";\n\nexport type InvoiceButtonProps = {\n  paymentRequest: string;\n};\nexport const InlineInvoiceCard = ({ paymentRequest, ...props }: Omit<BoxProps, \"children\"> & InvoiceButtonProps) => {\n  const { value: invoice, error } = useAsync(async () => parsePaymentRequest(paymentRequest));\n  const more = useDisclosure();\n\n  const [loading, setLoading] = useState(false);\n  const handleClick = async (event: React.SyntheticEvent) => {\n    if (!window.webln) return;\n\n    event.preventDefault();\n    setLoading(true);\n    try {\n      const provider = await requestProvider();\n      const response = await provider.sendPayment(paymentRequest);\n      if (response.preimage) {\n        console.log(\"Paid\");\n      }\n    } catch (e) {\n      console.log(\"Failed to pay invoice\");\n      console.log(e);\n    }\n    setLoading(false);\n  };\n\n  if (error) {\n    <>{paymentRequest}</>;\n  }\n\n  if (!invoice) return <>Loading Invoice...</>;\n\n  const isExpired = dayjs(invoice.expiry).isBefore(dayjs());\n\n  return (\n    <Flex\n      padding=\"3\"\n      borderColor=\"yellow.300\"\n      borderWidth=\"1px\"\n      rounded=\"md\"\n      direction=\"column\"\n      position=\"relative\"\n      {...props}\n    >\n      {more.isOpen ? (\n        <>\n          <Box maxW=\"3in\" mx=\"auto\" w=\"full\">\n            <QrCodeSvg content={invoice.paymentRequest} />\n          </Box>\n          <Flex gap=\"2\" mt=\"2\">\n            <Input value={invoice.paymentRequest} userSelect=\"all\" />\n            <CopyIconButton value={invoice.paymentRequest} aria-label=\"Copy Invoice\" />\n          </Flex>\n          <CloseButton onClick={more.onClose} position=\"absolute\" right=\"2\" top=\"2\" />\n        </>\n      ) : (\n        <Flex flexWrap=\"wrap\" gap=\"4\" alignItems=\"center\">\n          <Box flexGrow={1}>\n            <Text fontWeight=\"bold\">Lightning Invoice</Text>\n            <Text>{invoice.description}</Text>\n          </Box>\n          <Box>\n            <Text color={isExpired ? \"red.400\" : undefined}>\n              {isExpired ? \"Expired\" : \"Expires\"}: {dayjs(invoice.expiry).fromNow()}\n            </Text>\n          </Box>\n          <ButtonGroup variant=\"outline\">\n            <CopyIconButton value={invoice.paymentRequest} aria-label=\"Copy Invoice\" />\n            <IconButton icon={<QrCode02 boxSize={6} />} onClick={more.onToggle} aria-label=\"Show QrCode\" />\n            <Button as=\"a\" onClick={handleClick} isLoading={loading} href={`lightning:${paymentRequest}`}>\n              ⚡ Pay {invoice.amount ? readablizeSats(invoice.amount / 1000) + \" sats\" : \"\"}\n            </Button>\n          </ButtonGroup>\n        </Flex>\n      )}\n    </Flex>\n  );\n};\n","import {\n  Accordion,\n  AccordionButton,\n  AccordionIcon,\n  AccordionItem,\n  AccordionPanel,\n  Box,\n  Button,\n  Card,\n  Divider,\n  Flex,\n  Heading,\n  Spinner,\n  Text,\n  useDisclosure,\n} from \"@chakra-ui/react\";\nimport { ChainedDVMJob, getEventIdsFromJobs, getRequestInput, getRequestRelays } from \"../../../../helpers/nostr/dvm\";\nimport dayjs from \"dayjs\";\nimport { truncatedId } from \"../../../../helpers/nostr/event\";\nimport { CopyIconButton } from \"../../../../components/copy-icon-button\";\nimport { NostrEvent } from \"../../../../types/nostr-event\";\nimport UserLink from \"../../../../components/user/user-link\";\n\nfunction JobResult({ result }: { result: NostrEvent }) {\n  return (\n    <>\n      <Text isTruncated>\n        ID: {truncatedId(result.id)} <CopyIconButton size=\"xs\" aria-label=\"copy id\" value={result.id} />\n      </Text>\n      <Flex gap=\"2\" alignItems=\"center\" overflow=\"hidden\">\n        <Text isTruncated>Content: {result.content}</Text>{\" \"}\n        <CopyIconButton size=\"xs\" aria-label=\"copy content\" value={result.content} />\n      </Flex>\n    </>\n  );\n}\nfunction JobStatus({ status }: { status: NostrEvent }) {\n  return (\n    <>\n      <Text isTruncated>\n        ID: {truncatedId(status.id)} <CopyIconButton size=\"xs\" aria-label=\"copy id\" value={status.id} />\n      </Text>\n      <Text isTruncated>Status: {status.tags.find((t) => t[0] === \"status\")?.[1]}</Text>\n      <Text isTruncated>Content: {status.content}</Text>\n    </>\n  );\n}\n\nfunction ChainedJob({ job }: { job: ChainedDVMJob }) {\n  const input = getRequestInput(job.request);\n  const showNext = useDisclosure();\n  const showPrev = useDisclosure();\n\n  return (\n    <Card p=\"2\" variant=\"outline\">\n      <Text>\n        ID: {job.request.id} <CopyIconButton size=\"xs\" aria-label=\"copy id\" value={job.request.id} />\n      </Text>\n      {input && (\n        <Text>\n          Input: {truncatedId(input.value)} ({input.type})\n        </Text>\n      )}\n      <Heading size=\"sm\">Relays:</Heading>\n      <Text>{getRequestRelays(job.request).join(\", \")}</Text>\n      <Divider my=\"2\" />\n      {job.responses.map((response) => (\n        <>\n          <Heading>\n            <UserLink pubkey={response.pubkey} />\n          </Heading>\n          <Heading size=\"sm\">Status:</Heading>\n          {response.status ? <JobStatus status={response.status} /> : <Spinner />}\n          <Divider my=\"2\" />\n          <Heading size=\"sm\">Result:</Heading>\n          {response.result ? <JobResult result={response.result} /> : <Spinner />}\n        </>\n      ))}\n      <Divider my=\"2\" />\n      {job.prev && (\n        <>\n          <Flex gap=\"2\" alignItems=\"center\">\n            <Heading size=\"sm\">Previous ({truncatedId(job.prev.request.id)}):</Heading>\n            <Button onClick={showPrev.onToggle} size=\"xs\">\n              {showPrev.isOpen ? \"Hide\" : \"Show\"}\n            </Button>\n          </Flex>\n          {showPrev.isOpen && <ChainedJob job={job.prev} />}\n          <Divider my=\"2\" />\n        </>\n      )}\n      {job.next.length > 0 && (\n        <>\n          <Flex gap=\"2\" alignItems=\"center\">\n            <Heading size=\"sm\">Next ({job.next.length}):</Heading>\n            <Button onClick={showNext.onToggle} size=\"xs\">\n              {showNext.isOpen ? \"Hide\" : \"Show\"}\n            </Button>\n          </Flex>\n          {showNext.isOpen && (\n            <Flex gap=\"2\" direction=\"column\">\n              {job.next.map((next) => (\n                <ChainedJob key={next.request.id} job={next} />\n              ))}\n            </Flex>\n          )}\n        </>\n      )}\n    </Card>\n  );\n}\n\nfunction DebugChain({ chain }: { chain: ChainedDVMJob[] }) {\n  const showPages = useDisclosure();\n\n  return (\n    <>\n      <Text>Events: {getEventIdsFromJobs(chain).length}</Text>\n\n      <Flex gap=\"2\" alignItems=\"center\">\n        <Heading size=\"sm\">Pages ({chain.length}):</Heading>\n        <Button size=\"xs\" onClick={showPages.onToggle}>\n          {showPages.isOpen ? \"Hide\" : \"Show\"}\n        </Button>\n      </Flex>\n      {showPages.isOpen && (\n        <Flex gap=\"2\" direction=\"column\">\n          {chain.map((job) => (\n            <ChainedJob key={job.request.id} job={job} />\n          ))}\n        </Flex>\n      )}\n    </>\n  );\n}\n\nexport default function DebugChains({ chains }: { chains: ChainedDVMJob[][] }) {\n  return (\n    <Accordion>\n      {chains.map((chain) => (\n        <AccordionItem key={chain[0].request.id}>\n          <h2>\n            <AccordionButton>\n              <Box as=\"span\" flex=\"1\" textAlign=\"left\">\n                {dayjs.unix(chain[0].request.created_at).fromNow()}\n              </Box>\n              <AccordionIcon />\n            </AccordionButton>\n          </h2>\n          <AccordionPanel pb={4}>\n            <DebugChain chain={chain} />\n          </AccordionPanel>\n        </AccordionItem>\n      ))}\n    </Accordion>\n  );\n}\n","import {\n  Alert,\n  AlertDescription,\n  AlertIcon,\n  AlertTitle,\n  Box,\n  Button,\n  Card,\n  CardBody,\n  CardHeader,\n  Code,\n  Heading,\n  Spinner,\n  Text,\n} from \"@chakra-ui/react\";\nimport dayjs from \"dayjs\";\n\nimport {\n  ChainedDVMJob,\n  DVM_CONTENT_DISCOVERY_JOB_KIND,\n  getJobStatusType,\n  getResponseFromDVM,\n} from \"../../../../helpers/nostr/dvm\";\nimport { InlineInvoiceCard } from \"../../../../components/lightning/inline-invoice-card\";\nimport { DraftNostrEvent } from \"../../../../types/nostr-event\";\nimport { useReadRelays } from \"../../../../hooks/use-client-relays\";\nimport { DVMAvatarLink } from \"./dvm-avatar\";\nimport DVMLink from \"./dvm-name\";\nimport { AddressPointer } from \"nostr-tools/nip19\";\nimport useUserMailboxes from \"../../../../hooks/use-user-mailboxes\";\nimport { usePublishEvent } from \"../../../../providers/global/publish-provider\";\n\nfunction NextPageButton({ chain, pointer }: { pointer: AddressPointer; chain: ChainedDVMJob[] }) {\n  const publish = usePublishEvent();\n  const dvmRelays = useUserMailboxes(pointer.pubkey);\n  const readRelays = useReadRelays();\n\n  const lastJob = chain[chain.length - 1];\n  const requestNextPage = async () => {\n    const draft: DraftNostrEvent = {\n      kind: DVM_CONTENT_DISCOVERY_JOB_KIND,\n      created_at: dayjs().unix(),\n      content: \"\",\n      tags: [\n        [\"i\", lastJob.request.id, \"event\"],\n        [\"p\", pointer.pubkey],\n        [\"relays\", ...readRelays],\n        [\"expiration\", String(dayjs().add(1, \"day\").unix())],\n      ],\n    };\n\n    await publish(\"Next Page\", draft, dvmRelays?.inboxes);\n  };\n\n  const response = getResponseFromDVM(lastJob, pointer.pubkey);\n\n  return (\n    <Button\n      colorScheme=\"primary\"\n      onClick={requestNextPage}\n      isLoading={lastJob && !response?.result && !response?.status}\n      mx=\"auto\"\n      my=\"4\"\n      px=\"20\"\n    >\n      Next page\n    </Button>\n  );\n}\n\nexport default function FeedStatus({ chain, pointer }: { chain: ChainedDVMJob[]; pointer: AddressPointer }) {\n  const lastJob = chain[chain.length - 1];\n  const response = lastJob.responses.find((r) => r.pubkey === pointer.pubkey);\n  if (response?.result) return <NextPageButton pointer={pointer} chain={chain} />;\n\n  const cardProps = { w: \"full\", maxW: \"2xl\", mx: \"auto\", overflow: \"hidden\" };\n  const cardHeader = (\n    <CardHeader p=\"4\" alignItems=\"center\" display=\"flex\" gap=\"2\">\n      <DVMAvatarLink pointer={pointer} w=\"12\" />\n      <DVMLink pointer={pointer} fontWeight=\"bold\" fontSize=\"lg\" />\n    </CardHeader>\n  );\n\n  const statusEvent = response?.status;\n  if (!statusEvent)\n    return (\n      <Card {...cardProps}>\n        {cardHeader}\n        <CardBody px=\"4\" pb=\"4\" pt=\"0\" flexDirection=\"row\" display=\"flex\" alignItems=\"center\" gap=\"4\">\n          <Spinner />\n          <Heading size=\"sm\">Waiting for response...</Heading>\n        </CardBody>\n      </Card>\n    );\n\n  const statusType = getJobStatusType(lastJob, pointer.pubkey);\n  switch (statusType) {\n    case \"payment-required\":\n      const [_, msats, invoice] = statusEvent.tags.find((t) => t[0] === \"amount\") ?? [];\n\n      return (\n        <Card {...cardProps}>\n          {cardHeader}\n          <CardBody px=\"4\" pb=\"4\" pt=\"0\" gap=\"2\" display=\"flex\" flexDirection=\"column\">\n            <Heading size=\"sm\">{statusEvent.content}</Heading>\n            {invoice && <InlineInvoiceCard paymentRequest={invoice} />}\n          </CardBody>\n        </Card>\n      );\n    case \"processing\":\n      return (\n        <Alert status=\"info\" {...cardProps}>\n          <AlertIcon boxSize={8} />\n          <Box>\n            <AlertTitle>Processing</AlertTitle>\n            <AlertDescription>{statusEvent.content}</AlertDescription>\n          </Box>\n        </Alert>\n      );\n    case \"error\":\n      return (\n        <Alert status=\"error\" {...cardProps}>\n          <AlertIcon boxSize={8} />\n          <Box>\n            <AlertTitle>Error!</AlertTitle>\n            <AlertDescription>{statusEvent.content}</AlertDescription>\n          </Box>\n        </Alert>\n      );\n    default:\n      return (\n        <>\n          <Text>\n            Unknown status <Code>{statusType}</Code>\n          </Text>\n          <Text>{statusEvent.content}</Text>\n        </>\n      );\n  }\n}\n","import FeedStatus from \"./feed-status\";\nimport { AddressPointer } from \"nostr-tools/nip19\";\n\nimport { ChainedDVMJob, getEventIdsFromJobs } from \"../../../../helpers/nostr/dvm\";\nimport useSingleEvents from \"../../../../hooks/use-single-events\";\nimport TimelineItem from \"../../../../components/timeline-page/generic-note-timeline/timeline-item\";\n\nfunction FeedEvents({ chain }: { chain: ChainedDVMJob[] }) {\n  const eventIds = getEventIdsFromJobs(chain);\n  const events = useSingleEvents(eventIds);\n\n  return (\n    <>\n      {events.map((event) => (\n        <TimelineItem event={event} visible />\n      ))}\n    </>\n  );\n}\n\nexport default function Feed({ chain, pointer }: { chain: ChainedDVMJob[]; pointer: AddressPointer }) {\n  return (\n    <>\n      {chain.length > 0 && <FeedEvents chain={chain} />}\n      <FeedStatus chain={chain} pointer={pointer} />\n    </>\n  );\n}\n","import { AddressPointer } from \"nostr-tools/nip19\";\nimport useDVMMetadata from \"../../../../hooks/use-dvm-metadata\";\nimport { Select } from \"@chakra-ui/react\";\n\nexport default function DVMParams({\n  pointer,\n  params,\n  onChange,\n}: {\n  pointer: AddressPointer;\n  params: Record<string, string>;\n  onChange: (params: Record<string, string>) => void;\n}) {\n  const metadata = useDVMMetadata(pointer);\n\n  const paramsWithOptions = Object.entries(metadata?.nip90Params || {}).filter(\n    ([param, obj]) => obj.values && obj.values.length > 0,\n  );\n\n  return (\n    <>\n      {paramsWithOptions.map(([param, args]) => (\n        <Select\n          key={param}\n          isRequired={!!args.required}\n          w=\"10rem\"\n          onChange={(e) => onChange({ ...params, [param]: e.target.value })}\n        >\n          {args.values.map((value) => (\n            <option key={value} value={value}>\n              {value}\n            </option>\n          ))}\n        </Select>\n      ))}\n    </>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport {\n  Button,\n  Flex,\n  IconButton,\n  Modal,\n  ModalBody,\n  ModalCloseButton,\n  ModalContent,\n  ModalHeader,\n  ModalOverlay,\n  useDisclosure,\n} from \"@chakra-ui/react\";\nimport { ChevronLeftIcon } from \"@chakra-ui/icons\";\nimport dayjs from \"dayjs\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport {\n  DVM_CONTENT_DISCOVERY_JOB_KIND,\n  DVM_CONTENT_DISCOVERY_RESULT_KIND,\n  DVM_STATUS_KIND,\n  flattenJobChain,\n  chainJobs,\n  groupEventsIntoJobs,\n} from \"../../../helpers/nostr/dvm\";\nimport { DraftNostrEvent } from \"../../../types/nostr-event\";\nimport VerticalPageLayout from \"../../../components/vertical-page-layout\";\nimport useTimelineLoader from \"../../../hooks/use-timeline-loader\";\nimport { useReadRelays } from \"../../../hooks/use-client-relays\";\nimport useCurrentAccount from \"../../../hooks/use-current-account\";\nimport RequireCurrentAccount from \"../../../providers/route/require-current-account\";\nimport { CodeIcon } from \"../../../components/icons\";\nimport DebugChains from \"./components/debug-chains\";\nimport Feed from \"./components/feed\";\nimport { AddressPointer } from \"nostr-tools/nip19\";\nimport useParamsAddressPointer from \"../../../hooks/use-params-address-pointer\";\nimport DVMParams from \"./components/dvm-params\";\nimport useUserMailboxes from \"../../../hooks/use-user-mailboxes\";\nimport { usePublishEvent } from \"../../../providers/global/publish-provider\";\nimport { getHumanReadableCoordinate } from \"../../../services/replaceable-events\";\n\nfunction DVMFeedPage({ pointer }: { pointer: AddressPointer }) {\n  const [since] = useState(() => dayjs().subtract(1, \"hour\").unix());\n  const publish = usePublishEvent();\n  const navigate = useNavigate();\n  const account = useCurrentAccount()!;\n  const debugModal = useDisclosure();\n\n  const dvmRelays = useUserMailboxes(pointer.pubkey)?.outboxes;\n  const readRelays = useReadRelays(dvmRelays);\n  const { loader, timeline: events } = useTimelineLoader(\n    `${getHumanReadableCoordinate(pointer.kind, pointer.pubkey, pointer.identifier)}-jobs`,\n    readRelays,\n    [\n      {\n        authors: [account.pubkey, pointer.pubkey],\n        \"#p\": [account.pubkey, pointer.pubkey],\n        kinds: [DVM_CONTENT_DISCOVERY_JOB_KIND, DVM_CONTENT_DISCOVERY_RESULT_KIND, DVM_STATUS_KIND],\n        since,\n      },\n    ],\n  );\n  const jobs = groupEventsIntoJobs(events);\n  const pages = chainJobs(Array.from(Object.values(jobs)));\n  const jobChains = flattenJobChain(pages);\n\n  const [params, setParams] = useState<Record<string, string>>({});\n  const [requesting, setRequesting] = useState(false);\n  const requestNewFeed = async () => {\n    setRequesting(true);\n\n    const paramTags = Object.entries(params).map(([key, value]) => [\"param\", key, value]);\n    const draft: DraftNostrEvent = {\n      kind: DVM_CONTENT_DISCOVERY_JOB_KIND,\n      created_at: dayjs().unix(),\n      content: \"\",\n      tags: [\n        [\"p\", pointer.pubkey],\n        [\"relays\", ...readRelays],\n        [\"expiration\", String(dayjs().add(1, \"day\").unix())],\n        ...paramTags,\n      ],\n    };\n\n    await publish(\"Request Feed\", draft, dvmRelays);\n  };\n\n  useEffect(() => {\n    setRequesting(false);\n  }, [events.length]);\n\n  return (\n    <VerticalPageLayout>\n      <Flex gap=\"2\">\n        <Button leftIcon={<ChevronLeftIcon boxSize={6} />} onClick={() => navigate(-1)}>\n          Back\n        </Button>\n        <DVMParams pointer={pointer} params={params} onChange={setParams} />\n        <Button onClick={requestNewFeed} isLoading={requesting} colorScheme=\"primary\">\n          New Feed\n        </Button>\n        <IconButton icon={<CodeIcon />} ml=\"auto\" aria-label=\"View Raw\" title=\"View Raw\" onClick={debugModal.onOpen} />\n      </Flex>\n\n      {jobChains[0] && <Feed chain={jobChains[0]} pointer={pointer} />}\n\n      {debugModal.isOpen && (\n        <Modal isOpen onClose={debugModal.onClose} size=\"4xl\">\n          <ModalOverlay />\n          <ModalContent>\n            <ModalHeader p=\"4\">Jobs</ModalHeader>\n            <ModalCloseButton />\n            <ModalBody p=\"0\">\n              <DebugChains chains={jobChains} />\n            </ModalBody>\n          </ModalContent>\n        </Modal>\n      )}\n    </VerticalPageLayout>\n  );\n}\n\nexport default function DVMFeedView() {\n  const pointer = useParamsAddressPointer(\"addr\");\n\n  return (\n    <RequireCurrentAccount>\n      <DVMFeedPage pointer={pointer} />\n    </RequireCurrentAccount>\n  );\n}\n"],"names":["ChevronLeftIcon","createIcon","__extends","this","extendStatics","d","b","p","__","errors","fixError","error","newTarget","errorType","stack","fixStack","functionName","exclusion","lines","resultLines","line","MissingProviderError","_super","message","_newTarget","_this","RejectionError","ConnectionError","UnsupportedMethodError","RoutingError","InvalidDataError","InternalError","client","errors_1","require$$0","requestProvider","_","resolve","reject","webln","err","provider","__createBinding","o","m","k","k2","desc","__exportStar","exports","require$$1","require$$2","InlineInvoiceCard","paymentRequest","props","invoice","useAsync","parsePaymentRequest","more","useDisclosure","loading","setLoading","useState","handleClick","event","e","jsx","Fragment","isExpired","dayjs","Flex","jsxs","Box","QrCodeSvg","Input","CopyIconButton","CloseButton","Text","ButtonGroup","IconButton","QrCode02","Button","readablizeSats","JobResult","result","truncatedId","JobStatus","status","_a","t","ChainedJob","job","input","getRequestInput","showNext","showPrev","Card","Heading","getRequestRelays","Divider","response","UserLink","Spinner","next","DebugChain","chain","showPages","getEventIdsFromJobs","DebugChains","chains","Accordion","AccordionItem","AccordionButton","AccordionIcon","AccordionPanel","NextPageButton","pointer","publish","usePublishEvent","dvmRelays","useUserMailboxes","readRelays","useReadRelays","lastJob","requestNextPage","draft","DVM_CONTENT_DISCOVERY_JOB_KIND","getResponseFromDVM","FeedStatus","r","cardProps","cardHeader","CardHeader","DVMAvatarLink","DVMLink","statusEvent","CardBody","statusType","getJobStatusType","msats","Alert","AlertIcon","AlertTitle","AlertDescription","Code","FeedEvents","eventIds","events","useSingleEvents","TimelineItem","Feed","DVMParams","params","onChange","metadata","useDVMMetadata","paramsWithOptions","param","obj","args","Select","value","DVMFeedPage","since","navigate","useNavigate","account","useCurrentAccount","debugModal","loader","useTimelineLoader","getHumanReadableCoordinate","DVM_CONTENT_DISCOVERY_RESULT_KIND","DVM_STATUS_KIND","jobs","groupEventsIntoJobs","pages","chainJobs","jobChains","flattenJobChain","setParams","requesting","setRequesting","requestNewFeed","paramTags","key","useEffect","VerticalPageLayout","CodeIcon","Modal","ModalOverlay","ModalContent","ModalHeader","ModalCloseButton","ModalBody","DVMFeedView","useParamsAddressPointer","RequireCurrentAccount"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}