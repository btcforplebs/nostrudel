import{j as e,ac as k,h6 as P,b2 as w,bs as S,e as A,fz as L,r as d,aI as V,b_ as F,b$ as j,f as R,i as I,af as m,V as N,F as E,bt as z,aP as W,E as p,b as _,I as K,c0 as M,c1 as O,c2 as U,c3 as $,c4 as c,c5 as q,ae as B,dx as D,av as Y,a2 as G,h7 as H,h8 as g}from"./index-C6wlVu-O.js";import{T as J}from"./torrent-table-row-CXlkwpX-.js";import"./number-BsCqcFD4.js";import"./torrent-menu-DLKj8E4u.js";function Q({...r}){function l(a,t){var s;return e.jsxs(e.Fragment,{children:[e.jsx("option",{value:t.join(","),children:a.name}),(s=a.sub_category)==null?void 0:s.map(o=>l(o,[...t,o.tag]))]})}return e.jsxs(k,{...r,children:[e.jsx("option",{value:"",children:"All"}),P.map(a=>e.jsx("optgroup",{label:a.name,children:l(a,[a.tag])},a.tag))]})}function X(){const r=B(),l=D(),a=m(),t=Y(a.pubkey),[s,o]=d.useState(!1),u=async()=>{o(!0);try{const i=H.newKey();g.addAccount(i),g.switchAccount(i.pubkey),r("/relays")}catch(i){i instanceof Error&&l({description:i.message,status:"error"})}o(!1)};return!!t&&e.jsxs(G,{status:"warning",flexWrap:"wrap",children:["There are many jurisdictions where Torrenting is illegal, You should probably not use your personal nostr account.",e.jsx(p,{onClick:u,variant:"link",ml:"auto",isLoading:s,children:"Create anon account"})]})}function Z(){var h;const{filter:r,listId:l}=S(),a=A(),t=L("tags"),s=((h=t.value)==null?void 0:h.split(","))??[],o=d.useCallback(n=>{n.target.value?t.setValue(n.target.value):t.clearValue()},[t.setValue,t.clearValue]),u=V(),i=d.useCallback(n=>!(u(n)||!F(n)||s.length>0&&s.some(C=>!n.tags.some(y=>y[1]===C))),[u,s.join(",")]),f=d.useMemo(()=>{if(r)return s.length>0?{...r,kinds:[j],"#t":s}:{...r,kinds:[j]}},[s.join(","),r]),{loader:T,timeline:x}=R(`${l||"global"}-torrents`,a,f,{eventFilter:i}),b=I(T),v=m();return e.jsxs(N,{children:[!!v&&e.jsx(X,{}),e.jsxs(E,{gap:"2",children:[e.jsx(z,{}),e.jsx(Q,{maxW:"xs",value:s.join(","),onChange:o}),e.jsx(W,{}),e.jsx(p,{as:_,to:"/torrents/new",children:"New Torrent"})]}),e.jsx(K,{callback:b,children:e.jsx(M,{children:e.jsxs(O,{size:"sm",children:[e.jsx(U,{children:e.jsxs($,{children:[e.jsx(c,{children:"Tags"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Uploaded"}),e.jsx(c,{children:"Size"}),e.jsx(c,{children:"From"}),e.jsx(c,{})]})}),e.jsx(q,{children:x==null?void 0:x.map(n=>e.jsx(J,{torrent:n},n.id))})]})})})]})}function ne(){return e.jsx(w,{children:e.jsx(Z,{})})}export{ne as default};
//# sourceMappingURL=index-CAXef7at.js.map
